import{r as n,j as e,A as ge,d as pe,L as je,b as be,E as Se,O as Me,k as ye,n as we,B as P,C as k,S as H,p as ue,a as ke,u as he,Y as ve,z as se,$ as Re,l as X,V as o,a3 as Ce,a4 as Pe,T as O,a0 as Le,a1 as fe,h as Ee,a2 as Ne,f as We}from"./index-ppVKw9NX.js";import{u as $e,V as Ae,a as Te,D as Fe,S as De}from"./useHeartbeatSound-7Y0VI0Ad.js";import{P as Ve}from"./play-DIgxcmH-.js";const xe=[{label:"Cold (15°C)",value:15,hr:18,amplitude:1.3,color:"#3b82f6",bgColor:"bg-blue-600",borderColor:"border-blue-400"},{label:"Normal (25°C)",value:25,hr:24,amplitude:1,color:"#22c55e",bgColor:"bg-green-600",borderColor:"border-green-400"},{label:"Warm (35°C)",value:35,hr:36,amplitude:.7,color:"#ef4444",bgColor:"bg-red-600",borderColor:"border-red-400"}];function ee(i,l){const t=xe.find(C=>C.value===i)||xe[1],r=l==="heart-block"?36:t.hr,j=60/r*1e3;return{hr:r,amplitude:t.amplitude,periodMs:j,color:t.color}}function ze(i,l,t=0,r="extra-systole"){const j=g=>(1-Math.cos(g*Math.PI))/2,C=g=>g<.16?3-2*j(g/.16):g<.32?1+1*j((g-.16)/.16):g<.4?2:g<.56?2-2*j((g-.4)/.16):3*j((g-.56)/.44);let h;if(r==="extra-systole")if(t===2)i<.16?h=3-5*j(i/.16):i<.32?h=-2+5*j((i-.16)/.16):(i<.4||i<.56,h=3);else{h=C(i);const g={3:1/3,4:5/9,5:7/9,6:1};if(t in g){const v=g[t];h=3-(3-h)*v}}else if(r==="staircase"){const g={0:.4,1:.6,2:.8,3:.9};h=C(i);const v=g[t]??1;h=3-(3-h)*v}else r==="summation"?t>=1&&t<=3||t>=6?h=3:h=C(i):r==="heart-block"?t>=4&&t<=7||t>=12&&t<=15?h=3:h=C(i):r==="all-or-none"?(t===0||i<0?h=3:h=C(i),t===0&&i>=0&&i<.02&&(h-=.6)):h=C(i);return h*l}const A=({label:i,children:l,onHoverChange:t})=>e.jsx("group",{onPointerOver:r=>{t&&(r.stopPropagation(),t(i),document.body.style.cursor="pointer")},onPointerOut:()=>{t&&(t(null),document.body.style.cursor="auto")},children:l}),Be=({onHoverChange:i})=>e.jsx(A,{label:"Myograph Board",onHoverChange:i,children:e.jsxs("group",{position:[0,-.9,0],children:[e.jsx(P,{args:[4,.15,2.5],position:[0,0,0],children:e.jsx("meshStandardMaterial",{color:"#8B7355",roughness:.8})}),e.jsx(P,{args:[3.6,.05,2.1],position:[0,.1,0],children:e.jsx("meshStandardMaterial",{color:"#D2B48C",roughness:.9})}),[[-1.7,-.2,-1],[1.7,-.2,-1],[-1.7,-.2,1],[1.7,-.2,1]].map((l,t)=>e.jsx(k,{args:[.06,.08,.3],position:l,children:e.jsx("meshStandardMaterial",{color:"#5C4033",roughness:.7})},`leg-${t}`)),[[-1.2,.15,-.6],[-1.2,.15,.6],[1.2,.15,-.6],[1.2,.15,.6],[-.6,.15,-.8],[-.6,.15,.8],[.6,.15,-.8],[.6,.15,.8]].map((l,t)=>e.jsxs("group",{position:l,children:[e.jsx(k,{args:[.015,.015,.15],position:[0,.075,0],children:e.jsx("meshStandardMaterial",{color:"#c0c0c0",metalness:.9,roughness:.1})}),e.jsx(H,{args:[.02,8,8],position:[0,.15,0],children:e.jsx("meshStandardMaterial",{color:"#e0e0e0",metalness:.8,roughness:.2})})]},`pin-${t}`))]})}),_e=({contraction:i,temperature:l,onHoverChange:t,showLigature1:r,isTight1:j,showLigature2:C,isTight2:h})=>{const g=n.useRef(null),v=n.useRef(null),N=n.useRef(null),c=n.useRef(null),a=n.useRef(null),s=n.useRef(null),D=n.useRef(null),z=n.useRef(null),T=n.useMemo(()=>l<=15?"#8B0000":l>=35?"#FF4444":"#be123c",[l]),K=n.useMemo(()=>new ke(T).multiplyScalar(.8).getHexString(),[T]);he(()=>{if(v.current){const M=3-i,u=Math.max(.4,1-M*.05),L=Math.max(.5,1-M*.05);if(v.current.scale.set(u,L,u),s.current){const y=-.3*L;s.current.position.set(0,y,.05*u),s.current.scale.set(u,1,u)}const E=Math.max(.8,1-M*.04);D.current&&D.current.scale.set(E,E,E),z.current&&z.current.scale.set(E*(j?.9:1.05),E*(j?.9:1.05),1)}if(N.current&&c.current&&(N.current.scale.set(1,1,1),c.current.scale.set(1,1,1)),a.current){const u=1+(3-i)*.05;a.current.scale.set(u,1,u)}});const m=n.useMemo(()=>{const M=new ve([new se(0,-.6),new se(.15,-.4),new se(.28,-.1),new se(.32,.2),new se(.25,.5),new se(.15,.6),new se(0,.65)]),u=new Re(M.getPoints(20),32);return u.computeVertexNormals(),u},[]),re=n.useMemo(()=>new X([new o(0,.6,.1),new o(0,.85,.15)]),[]),oe=n.useMemo(()=>new X([new o(0,.85,.15),new o(-.25,1,.05),new o(-.4,1.05,-.1)]),[]),U=n.useMemo(()=>new X([new o(0,.85,.15),new o(.25,1,.05),new o(.4,1.05,-.1)]),[]),f=.18,R=.18,B=.12,x=.3,G=0,ie=n.useMemo(()=>new X([new o(-.4,.6,.1),new o(-.3,.4,.15),new o(-f,G+R-.05,x)]),[]),Y=n.useMemo(()=>new X([new o(.4,.6,.1),new o(.3,.4,.15),new o(f,G+R-.05,x)]),[]),ne=n.useMemo(()=>new X([new o(0,G-R+.05,x),new o(0,-.6,.1),new o(0,-.7,.1)]),[]),ae=n.useMemo(()=>{const M=new Ce,u=f,L=R,E=B;M.moveTo(-u+E,-L),M.lineTo(u-E,-L),M.quadraticCurveTo(u,-L,u-.06,-L+.1),M.lineTo(.06,L-.1),M.quadraticCurveTo(0,L,-.06,L-.1),M.lineTo(-u+.06,-L+.1),M.quadraticCurveTo(-u,-L,-u+E,-L);const y={depth:.08,bevelEnabled:!0,bevelSegments:8,steps:2,bevelSize:.05,bevelThickness:.05},$=new Pe(M,y);return $.center(),$},[]),le=n.useMemo(()=>{const M=f+.08,u=R+.08,L=[new o(0,-u,0),new o(M-.1,-u,0),new o(M,-u+.1,0),new o(M-.05,0,0),new o(0,u+.02,0),new o(-.21000000000000002,0,0),new o(-M,-u+.1,0),new o(-.16,-u,0)];return new X(L,!0)},[]),w=n.useMemo(()=>new X([new o(0,R+.08,0),new o(.08,R+.18,.1),new o(.12,R+.28,.15)]),[]),_=n.useMemo(()=>new X([new o(0,R+.08,0),new o(-.08,R+.18,.1),new o(-.12,R+.28,.15)]),[]),W=n.useMemo(()=>new X([new o(.21,0,0),new o(.35,.1,.05),new o(.4,.2,.1)]),[]),S=n.useMemo(()=>new X([new o(.21,0,0),new o(.35,-.1,.05),new o(.4,-.2,.1)]),[]);return e.jsx(A,{label:"Frog Heart (Sinus Venosus → Atria → Ventricle)",onHoverChange:t,children:e.jsxs("group",{ref:g,position:[0,-.2,0],rotation:[0,0,Math.PI],children:[e.jsxs("group",{position:[0,.55,0],children:[e.jsx("group",{ref:c,position:[.18,0,-.05],rotation:[0,0,-.2],children:e.jsx(A,{label:"Right Atrium",onHoverChange:t,children:e.jsx(H,{args:[.22,32,32],scale:[1,1.1,.9],children:e.jsx("meshPhysicalMaterial",{color:"#"+K,roughness:.4,metalness:.1,clearcoat:1,clearcoatRoughness:.2})})})}),e.jsx("group",{ref:N,position:[-.18,.05,-.05],rotation:[0,0,.2],children:e.jsx(A,{label:"Left Atrium",onHoverChange:t,children:e.jsx(H,{args:[.16,32,32],scale:[1,1.1,.9],children:e.jsx("meshPhysicalMaterial",{color:"#"+K,roughness:.4,metalness:.1,clearcoat:1,clearcoatRoughness:.2})})})})]}),e.jsx("group",{ref:v,position:[0,0,.05],children:e.jsx(A,{label:"Ventricle",onHoverChange:t,children:e.jsx("mesh",{geometry:m,children:e.jsx("meshPhysicalMaterial",{color:T,roughness:.5,metalness:.1,clearcoat:1,clearcoatRoughness:.3})})})}),e.jsx("group",{ref:a,children:e.jsxs(A,{label:"Truncus Arteriosus (Branching)",onHoverChange:t,children:[e.jsx(O,{args:[re,16,.06,12,!1],children:e.jsx("meshPhysicalMaterial",{color:"#d64949",roughness:.4,clearcoat:1})}),e.jsx(O,{args:[oe,16,.045,8,!1],children:e.jsx("meshPhysicalMaterial",{color:"#d64949",roughness:.4,clearcoat:1})}),e.jsx(O,{args:[U,16,.045,8,!1],children:e.jsx("meshPhysicalMaterial",{color:"#d64949",roughness:.4,clearcoat:1})})]})}),e.jsxs(A,{label:"Vena Cavae",onHoverChange:t,children:[e.jsx(O,{args:[ie,12,.035,8,!1],children:e.jsx("meshPhysicalMaterial",{color:"#5e4b8b",roughness:.6})}),e.jsx(O,{args:[Y,12,.035,8,!1],children:e.jsx("meshPhysicalMaterial",{color:"#5e4b8b",roughness:.6})}),e.jsx(O,{args:[ne,12,.035,8,!1],children:e.jsx("meshPhysicalMaterial",{color:"#5e4b8b",roughness:.6})})]}),e.jsx(A,{label:"Sinus Venosus (Posterior)",onHoverChange:t,children:e.jsx("mesh",{ref:D,geometry:ae,position:[0,G,x],rotation:[0,0,Math.PI],children:e.jsx("meshPhysicalMaterial",{color:"#4a2c2c",roughness:.8})})}),r&&e.jsx(A,{label:"1st Stannius Ligature",onHoverChange:t,children:e.jsxs("group",{ref:z,position:[0,G,x],rotation:[0,0,Math.PI],children:[e.jsx(O,{args:[le,64,j?.025:.035,8,!0],scale:[j?.9:1.05,j?.9:1.05,1],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})}),e.jsx(H,{args:[.05,8,8],position:[0,R+.08,0],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})}),e.jsx(O,{args:[w,12,.025,6,!1],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})}),e.jsx(O,{args:[_,12,.025,6,!1],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})})]})}),C&&e.jsx(A,{label:"2nd Stannius Ligature",onHoverChange:t,children:e.jsxs("group",{ref:s,position:[0,-.3,.05],children:[e.jsx(ue,{args:[.2,.03,8,24],rotation:[Math.PI/2,0,0],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})}),e.jsx(H,{args:[.05,8,8],position:[.21,0,0],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})}),e.jsx(O,{args:[W,12,.02,6,!1],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})}),e.jsx(O,{args:[S,12,.02,6,!1],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})})]})})]})})},Ie=({onHoverChange:i})=>e.jsx(A,{label:"Frog (Pithed)",onHoverChange:i,children:e.jsxs("group",{position:[0,-.4,.2],rotation:[-.1,0,0],children:[e.jsx(H,{args:[.5,32,32],scale:[2.2,1,3],position:[0,0,0],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})}),e.jsxs("group",{position:[0,.45,-.5],rotation:[.1,0,0],children:[e.jsx(ue,{args:[.28,.05,16,24],rotation:[Math.PI/2,0,0],scale:[1,1,1.2],position:[0,.02,0],children:e.jsx("meshStandardMaterial",{color:"#661111",roughness:.5})}),e.jsxs("group",{position:[-.4,.02,0],rotation:[0,0,.3],children:[e.jsx(P,{args:[.3,.03,.6],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})}),e.jsx(P,{args:[.28,.031,.58],position:[.05,-.005,0],children:e.jsx("meshStandardMaterial",{color:"#4a1c1c",roughness:.7})})]}),e.jsxs("group",{position:[.4,.02,0],rotation:[0,0,-.3],children:[e.jsx(P,{args:[.3,.03,.6],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})}),e.jsx(P,{args:[.28,.031,.58],position:[-.05,-.005,0],children:e.jsx("meshStandardMaterial",{color:"#4a1c1c",roughness:.7})})]}),e.jsxs("group",{position:[0,.05,-.4],rotation:[.4,0,0],children:[e.jsx(P,{args:[.5,.03,.25],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})}),e.jsx(P,{args:[.48,.031,.23],position:[0,-.005,.05],children:e.jsx("meshStandardMaterial",{color:"#4a1c1c",roughness:.7})})]}),e.jsxs("group",{position:[0,.05,.4],rotation:[-.4,0,0],children:[e.jsx(P,{args:[.5,.03,.25],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})}),e.jsx(P,{args:[.48,.031,.23],position:[0,-.005,-.05],children:e.jsx("meshStandardMaterial",{color:"#4a1c1c",roughness:.7})})]})]}),e.jsxs("group",{position:[0,.1,-1.6],children:[e.jsx(H,{args:[.4,32,32],scale:[1.5,.8,1.2],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})}),e.jsx(H,{args:[.1,16,16],position:[.3,.2,-.1],children:e.jsx("meshStandardMaterial",{color:"#111",roughness:.2})}),e.jsx(H,{args:[.1,16,16],position:[-.3,.2,-.1],children:e.jsx("meshStandardMaterial",{color:"#111",roughness:.2})})]}),e.jsx("group",{position:[.9,-.1,1],rotation:[0,.5,0],children:e.jsx(k,{args:[.2,.15,1.2],rotation:[0,0,1.2],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})})}),e.jsx("group",{position:[-.9,-.1,1],rotation:[0,-.5,0],children:e.jsx(k,{args:[.2,.15,1.2],rotation:[0,0,-1.2],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})})}),e.jsx("group",{position:[.8,-.1,-.8],rotation:[0,-.3,0],children:e.jsx(k,{args:[.12,.1,1],rotation:[0,0,1.3],children:e.jsx("meshStandardMaterial",{color:"#8da399",roughness:.8})})}),e.jsx("group",{position:[-.8,-.1,-.8],rotation:[0,.3,0],children:e.jsx(k,{args:[.12,.1,1],rotation:[0,0,-1.3],children:e.jsx("meshStandardMaterial",{color:"#8da399",roughness:.8})})})]})}),Xe=({length:i,radius:l,coils:t,color:r,thickness:j})=>{const h=n.useMemo(()=>{const g=[],v=t*12;for(let c=0;c<=v;c++){const a=c/v,s=a*Math.PI*2*t,D=l*Math.cos(s),z=l*Math.sin(s),T=-a*1;g.push(new o(D,T,z))}const N=new X(g);return new Ne(N,v,j,8,!1)},[l,t,j]);return e.jsx("group",{scale:[1,i/1,1],children:e.jsx("mesh",{geometry:h,children:e.jsx("meshStandardMaterial",{color:r,metalness:.6,roughness:.4})})})},Ge=({angle:i,onHoverChange:l})=>{const t="#e2e8f0",r="#94a3b8",j="#475569",C="#f1f5f9",v=[-1.5,.7,.15],N=-i,a=.75+i*.9,s=[.6,0,0];return e.jsxs("group",{position:[0,.5,.5],children:[e.jsx(A,{label:"Starling Lever (Stand Post)",onHoverChange:l,children:e.jsx(k,{args:[.06,.06,4.5],position:[-1.5,0,0],children:e.jsx("meshStandardMaterial",{color:r,metalness:.6,roughness:.4})})}),e.jsx(A,{label:"Starling Lever (Tension Adjuster)",onHoverChange:l,children:e.jsxs("group",{position:[-.75,.4,0],rotation:[0,0,1.57],children:[e.jsx(k,{args:[.025,.025,1],position:[.8,.05,0],rotation:[0,0,Math.PI/2],children:e.jsx("meshStandardMaterial",{color:t,metalness:.6})}),e.jsxs("group",{position:[1.1,.05,0],children:[e.jsx(P,{args:[.1,.15,.1],children:e.jsx("meshStandardMaterial",{color:t})}),e.jsx(k,{args:[.015,.015,.6],position:[0,-.17,0],children:e.jsx("meshStandardMaterial",{color:t,metalness:.5})}),e.jsx(k,{args:[.05,.05,.04],position:[0,.13,0],children:e.jsx("meshStandardMaterial",{color:j,roughness:.8})}),e.jsx(ue,{args:[.025,.005,8,16],position:[0,-.47,0],rotation:[Math.PI/2,0,0],children:e.jsx("meshStandardMaterial",{color:t})})]})]})}),e.jsxs("group",{position:v,children:[e.jsxs("group",{position:[.3,0,-.14],children:[e.jsx(A,{label:"Starling Lever (Mounting Clamp)",onHoverChange:l,children:e.jsxs("group",{children:[e.jsx(P,{args:[.85,.13,.4],children:e.jsx("meshStandardMaterial",{color:t,metalness:.7})}),e.jsxs("group",{position:[-.5,0,0],rotation:[0,0,Math.PI/2],children:[e.jsx(k,{args:[.03,.03,.1],children:e.jsx("meshStandardMaterial",{color:j})}),e.jsx(k,{args:[.07,.07,.02],position:[0,.05,0],children:e.jsx("meshStandardMaterial",{color:j})})]})]})}),e.jsxs("group",{position:[.55,0,0],children:[e.jsx(P,{args:[.05,.13,.35],position:[-.1,0,0],children:e.jsx("meshStandardMaterial",{color:t,metalness:.7})}),e.jsx(P,{args:[.25,.13,.04],position:[0,0,.18],children:e.jsx("meshStandardMaterial",{color:t,metalness:.7})}),e.jsx(P,{args:[.25,.13,.04],position:[0,0,-.18],children:e.jsx("meshStandardMaterial",{color:t,metalness:.7})})]}),e.jsxs("group",{rotation:[0,0,N],position:s,children:[e.jsx(k,{args:[.02,.02,.35],rotation:[Math.PI/2,0,0],children:e.jsx("meshStandardMaterial",{color:j})}),e.jsx(A,{label:"Starling Lever (Lever Arm)",onHoverChange:l,children:e.jsxs("group",{position:[.5,0,0],children:[e.jsx(P,{args:[1.2,.12,.03],children:e.jsx("meshStandardMaterial",{color:C,roughness:.3,metalness:.2})}),[-.4,-.2,0,.2,.4].map((D,z)=>e.jsx("group",{position:[D,0,0],rotation:[Math.PI/2,0,0],children:e.jsx(k,{args:[.025,.025,.032],children:e.jsx("meshBasicMaterial",{color:"#1e293b"})})},z))]})}),e.jsx(A,{label:"Starling Lever (Writing Stylus)",onHoverChange:l,children:e.jsxs("group",{position:[1.18,0,0],children:[e.jsx(P,{args:[.08,.08,.08],position:[-.04,0,0],children:e.jsx("meshStandardMaterial",{color:t})}),e.jsx(k,{args:[.012,.012,2.9],position:[1.45,0,0],rotation:[0,0,Math.PI/2],children:e.jsx("meshStandardMaterial",{color:"#222",roughness:.6})}),e.jsx(fe,{args:[.012,.06,8],position:[2.9,0,0],rotation:[0,0,-Math.PI/2],children:e.jsx("meshStandardMaterial",{color:"#111"})})]})})]})]}),e.jsx(A,{label:"Starling Lever (Spring)",onHoverChange:l,children:e.jsx("group",{position:[1.15,.8,-.15],children:e.jsx(Xe,{length:a,radius:.04,coils:14,color:"#cbd5e1",thickness:.01})})})]})]})},Oe=({contraction:i})=>{const{start:t,end:r,len:j,midpoint:C,quaternion:h}=n.useMemo(()=>{const s=-((3-i)*.036),D=1.16+Math.sin(s)*1,z=new o(0,.06-(3-i)*.03,0),T=new o(0,D,0),K=z.distanceTo(T),m=new o().addVectors(z,T).multiplyScalar(.5),re=new o(0,1,0),oe=new o().subVectors(T,z).normalize(),U=new Le().setFromUnitVectors(re,oe);return{start:z,end:T,len:K,midpoint:m,quaternion:U}},[i]),g=n.useMemo(()=>new X([new o(0,-.015,0),new o(0,-.12,0),new o(-.01,-.14,0),new o(-.04,-.14,0),new o(-.05,-.1,0)]),[]);return e.jsxs("group",{position:[0,.1,.5],children:[e.jsxs("mesh",{position:C,quaternion:h,scale:[1,j,1],children:[e.jsx("cylinderGeometry",{args:[.003,.003,1,8]}),e.jsx("meshStandardMaterial",{color:"#f0f0f0",roughness:.5})]}),e.jsxs("group",{position:t,rotation:[0,0,.1],children:[e.jsx(ue,{args:[.015,.003,8,16],rotation:[0,Math.PI/2,0],children:e.jsx("meshStandardMaterial",{color:"#888",metalness:.8,roughness:.2})}),e.jsx(O,{args:[g,32,.003,8,!1],children:e.jsx("meshStandardMaterial",{color:"#888",metalness:.8,roughness:.2})}),e.jsx(k,{args:[.001,.003,.02],position:[-.052,-.09,0],rotation:[0,0,-.2],children:e.jsx("meshStandardMaterial",{color:"#888",metalness:.8,roughness:.2})}),e.jsx(fe,{args:[.002,.01,8],position:[-.052,-.1,0],rotation:[0,0,2.8],children:e.jsx("meshStandardMaterial",{color:"#888",metalness:.8,roughness:.2})})]})]})},Ue=({simTime:i,waveformValue:l,isRecording:t,onHoverChange:r,resetKey:j,drumSpeed:C})=>{const h=n.useRef(document.createElement("canvas")),g=n.useRef(null),v=n.useMemo(()=>{const c=h.current;c.width=2048,c.height=512;const a=c.getContext("2d");if(a){a.fillStyle="#1a1a1a",a.fillRect(0,0,2048,512),a.fillStyle="#0d0d0d";for(let s=0;s<200;s++)a.fillRect(Math.random()*2048,Math.random()*512,Math.random()*4,Math.random()*4)}return new Ee(c)},[]);n.useEffect(()=>{const c=h.current.getContext("2d");if(c){c.fillStyle="#1a1a1a",c.fillRect(0,0,2048,512),c.fillStyle="#0d0d0d";for(let a=0;a<200;a++)c.fillRect(Math.random()*2048,Math.random()*512,Math.random()*4,Math.random()*4);v.needsUpdate=!0}g.current=null},[j,v]),he(()=>{if(!t){g.current=null;return}const c=h.current.getContext("2d");if(!c)return;const s=80+i/1e3*C*15,D=512*.5-l*30;g.current&&(c.strokeStyle="#ffffff",c.lineWidth=2.5,c.shadowColor="#ffffff",c.shadowBlur=1,c.beginPath(),c.moveTo(g.current.x,g.current.y),c.lineTo(s,D),c.stroke(),c.shadowBlur=0,v.needsUpdate=!0),g.current={x:s,y:D}});const N=n.useRef(null);return he(()=>{if(N.current&&t){const s=(80+i/1e3*C*15-80)/2048*(2*Math.PI),D=1.8+Math.PI;N.current.rotation.y=D-s}}),e.jsx(A,{label:"Kymograph Drum",onHoverChange:r,children:e.jsxs("group",{position:[0,0,0],children:[e.jsx("group",{ref:N,rotation:[0,1.8+Math.PI,0],children:e.jsxs(k,{args:[1,1,2.5,64],children:[e.jsx("meshBasicMaterial",{attach:"material-0",map:v}),e.jsx("meshStandardMaterial",{attach:"material-1",color:"#111"}),e.jsx("meshStandardMaterial",{attach:"material-2",color:"#111"})]})}),e.jsx(k,{args:[.06,.06,3.5],position:[0,-.15,0],children:e.jsx("meshStandardMaterial",{color:"#1e293b",metalness:.8})}),e.jsx(P,{args:[1.2,.45,1.5],position:[0,-1.75,0],children:e.jsx("meshStandardMaterial",{color:"#0f172a",metalness:.3,roughness:.6})})]})})},Ye=({data:i,temperature:l,isRecording:t,selectedExperiment:r,drumSpeed:j,heartRate:C})=>{xe.find(w=>w.value===l)||xe[1];const h="#4ade80",g="#14532d",v="#166534",N="#020617",c=900,a=320,s={top:110,right:20,bottom:40,left:40},D=c-s.left-s.right,z=a-s.top-s.bottom,T=-2.5,K=3.5,m=w=>s.top+z-(w-T)/(K-T)*z,U=24e3*(2.5/Math.max(.5,j)),f=i.length>0?i[i.length-1].t:0,R=Math.max(0,f-U),B=Math.max(U,f+200),x=w=>s.left+(w-R)/(B-R)*D,G=i.filter(w=>w.t>=R-500),ie=G.length>1?`M ${G.map(w=>`${x(w.t)},${m(w.y)}`).join(" L ")}`:"",Y=[],ne=Math.ceil(R/500)*500,ae=U>6e4?5e3:U>3e4?1e3:500;for(let w=ne;w<=B;w+=ae)Y.push(w);const le=[0,1,2,3];return e.jsxs("svg",{viewBox:`0 0 ${c} ${a}`,className:"w-full h-full",preserveAspectRatio:"xMidYMid meet",children:[e.jsx("rect",{x:0,y:0,width:c,height:a,fill:N,rx:8}),e.jsx("pattern",{id:"scanlines",patternUnits:"userSpaceOnUse",width:"4",height:"4",children:e.jsx("line",{x1:"0",y1:"0",x2:"4",y2:"0",stroke:"#000",strokeOpacity:"0.2",strokeWidth:"1"})}),e.jsx("rect",{x:0,y:0,width:c,height:a,fill:"url(#scanlines)",pointerEvents:"none"}),le.map((w,_)=>e.jsx("line",{x1:s.left,y1:m(w),x2:c-s.right,y2:m(w),stroke:w===0?v:g,strokeWidth:1},`hgrid-${_}`)),Y.map((w,_)=>e.jsx("line",{x1:x(w),y1:s.top,x2:x(w),y2:a-s.bottom,stroke:w%1e3===0?v:g,strokeWidth:1},`tmark-${_}`)),e.jsxs("defs",{children:[e.jsxs("filter",{id:"oscilloscopeGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[e.jsx("feGaussianBlur",{stdDeviation:"2",result:"blur"}),e.jsx("feComposite",{in:"SourceGraphic",in2:"blur",operator:"over"})]}),e.jsx("marker",{id:"arrowAmber",viewBox:"0 0 10 10",refX:"10",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto",children:e.jsx("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:"#f59e0b"})}),e.jsx("marker",{id:"arrowBlue",viewBox:"0 0 10 10",refX:"10",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto",children:e.jsx("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:"#38bdf8"})})]}),e.jsx("path",{d:ie,fill:"none",stroke:h,strokeWidth:2,filter:"url(#oscilloscopeGlow)"}),(()=>{const w=ee(l,r),_=w.periodMs,W=_*2+_*.16,S=x(W),M=_*2+_*.7,u=x(M),L=_*3,E=_*7,y=x(L),$=x(E),Z=(y+$)/2;if(i.length===0||t&&r!=="summation")return null;if(r==="extra-systole")return e.jsxs(e.Fragment,{children:[e.jsxs("g",{children:[e.jsx("text",{x:S,y:m(-2)+110,textAnchor:"middle",fill:"#f59e0b",fontSize:24,fontFamily:"monospace",fontWeight:"bold",style:{filter:"drop-shadow(0 0 4px rgba(0,0,0,0.8))"},children:"Extra Systole"}),e.jsx("line",{x1:S,y1:m(-2)+85,x2:S,y2:m(-2)+12,stroke:"#f59e0b",strokeWidth:3}),e.jsx("path",{d:`M ${S-10} ${m(-2)+22} L ${S} ${m(-2)+8} L ${S+10} ${m(-2)+22}`,fill:"none",stroke:"#f59e0b",strokeWidth:3,strokeLinejoin:"round"})]}),e.jsxs("g",{children:[e.jsx("text",{x:u,y:m(3)-90,textAnchor:"middle",fill:"#38bdf8",fontSize:24,fontFamily:"monospace",fontWeight:"bold",style:{filter:"drop-shadow(0 0 4px rgba(0,0,0,0.8))"},children:"Compensatory Pause"}),e.jsx("line",{x1:u,y1:m(3)-65,x2:u,y2:m(3)-10,stroke:"#38bdf8",strokeWidth:3}),e.jsx("path",{d:`M ${u-10} ${m(3)-22} L ${u} ${m(3)-8} L ${u+10} ${m(3)-22}`,fill:"none",stroke:"#38bdf8",strokeWidth:3,strokeLinejoin:"round"})]}),e.jsxs("g",{children:[e.jsx("line",{x1:y,y1:a-s.bottom+15,x2:$,y2:a-s.bottom+15,stroke:"#c084fc",strokeWidth:3}),e.jsx("line",{x1:y,y1:a-s.bottom+5,x2:y,y2:a-s.bottom+25,stroke:"#c084fc",strokeWidth:3}),e.jsx("line",{x1:$,y1:a-s.bottom+5,x2:$,y2:a-s.bottom+25,stroke:"#c084fc",strokeWidth:3}),e.jsx("text",{x:Z,y:a-s.bottom+65,textAnchor:"middle",fill:"#c084fc",fontSize:26,fontFamily:"monospace",fontWeight:"bold",style:{filter:"drop-shadow(0 0 4px rgba(0,0,0,0.8))"},children:"Treppe (Staircase)"})]})]});if(r==="summation"){const q=ee(l,r).periodMs,I=0,d=q*2,b=q*4,V=x(I),p=a-s.bottom+40,F=[];F.push(0),F.push(d);for(let J=0;J<5;J++)F.push(b-1250+J*250);const de=F.filter(J=>!t||J<=f),Q=t?Math.min(c-s.right,x(f)):c-s.right,ce=s.left;return e.jsxs(e.Fragment,{children:[Q>ce&&e.jsx("line",{x1:ce,y1:p,x2:Q,y2:p,stroke:"#ef4444",strokeWidth:2}),de.map((J,me)=>e.jsx("line",{x1:x(J),y1:p-10,x2:x(J),y2:p+10,stroke:"#ef4444",strokeWidth:2},me)),(!t||f>=I)&&e.jsxs("g",{children:[e.jsx("text",{x:V,y:p+100,textAnchor:"start",fill:"#22c55e",fontSize:18,fontFamily:"monospace",fontWeight:"bold",children:"Threshold"}),e.jsx("line",{x1:V+5,y1:p+75,x2:V,y2:p+15,stroke:"#22c55e",strokeWidth:2,strokeDasharray:"4 2"}),e.jsx("path",{d:`M ${V-4} ${p+20} L ${V} ${p+12} L ${V+4} ${p+20}`,fill:"none",stroke:"#22c55e",strokeWidth:2})]}),(!t||f>=d)&&e.jsxs("g",{children:[e.jsx("text",{x:x(d),y:p+100,textAnchor:"middle",fill:"#fbbf24",fontSize:18,fontFamily:"monospace",fontWeight:"bold",children:"Sub-threshold"}),e.jsx("line",{x1:x(d),y1:p+75,x2:x(d),y2:p+15,stroke:"#fbbf24",strokeWidth:2,strokeDasharray:"4 2"}),e.jsx("path",{d:`M ${x(d)-4} ${p+20} L ${x(d)} ${p+12} L ${x(d)+4} ${p+20}`,fill:"none",stroke:"#fbbf24",strokeWidth:2})]}),(!t||f>=b-1250)&&e.jsxs("g",{children:[e.jsx("line",{x1:x(b-1250),y1:p+15,x2:x(b-250),y2:p+15,stroke:"#ef4444",strokeWidth:2}),e.jsx("line",{x1:x(b-1250),y1:p+10,x2:x(b-1250),y2:p+20,stroke:"#ef4444",strokeWidth:2}),e.jsx("line",{x1:x(b-250),y1:p+10,x2:x(b-250),y2:p+20,stroke:"#ef4444",strokeWidth:2}),e.jsx("text",{x:x(b-1250),y:p+40,textAnchor:"start",fill:"#ef4444",fontSize:18,fontFamily:"monospace",fontWeight:"bold",children:"Summation (5 subthreshold)"})]})]})}if(r==="staircase"){const q=_*4,I=x(0),d=x(q),b=(I+d)/2;return e.jsxs("g",{children:[e.jsx("line",{x1:I,y1:a-s.bottom+15,x2:d,y2:a-s.bottom+15,stroke:"#c084fc",strokeWidth:3}),e.jsx("line",{x1:I,y1:a-s.bottom+5,x2:I,y2:a-s.bottom+25,stroke:"#c084fc",strokeWidth:3}),e.jsx("line",{x1:d,y1:a-s.bottom+5,x2:d,y2:a-s.bottom+25,stroke:"#c084fc",strokeWidth:3}),e.jsx("text",{x:b,y:a-s.bottom+65,textAnchor:"middle",fill:"#c084fc",fontSize:26,fontFamily:"monospace",fontWeight:"bold",style:{filter:"drop-shadow(0 0 4px rgba(0,0,0,0.8))"},children:"Treppe (Staircase)"})]})}if(r==="heart-block"){const d=x(9999.5),p=(23333+33333)/2,F=x(p);return e.jsxs(e.Fragment,{children:[e.jsxs("g",{children:[e.jsx("text",{x:d,y:m(3)-130,textAnchor:"middle",fill:"#f59e0b",fontSize:24,fontFamily:"monospace",fontWeight:"bold",style:{filter:"drop-shadow(0 0 4px rgba(0,0,0,0.8))"},children:"1st Stannius Ligature"}),e.jsx("line",{x1:d,y1:m(3)-105,x2:d,y2:m(3)-12,stroke:"#f59e0b",strokeWidth:3}),e.jsx("path",{d:`M ${d-10} ${m(3)-22} L ${d} ${m(3)-8} L ${d+10} ${m(3)-22}`,fill:"none",stroke:"#f59e0b",strokeWidth:3,strokeLinejoin:"round"})]}),e.jsxs("g",{children:[e.jsx("text",{x:F,y:m(3)-70,textAnchor:"middle",fill:"#38bdf8",fontSize:24,fontFamily:"monospace",fontWeight:"bold",style:{filter:"drop-shadow(0 0 4px rgba(0,0,0,0.8))"},children:"2nd Stannius Ligature"}),e.jsx("line",{x1:F,y1:m(3)-45,x2:F,y2:m(3)-12,stroke:"#38bdf8",strokeWidth:3}),e.jsx("path",{d:`M ${F-10} ${m(3)-22} L ${F} ${m(3)-8} L ${F+10} ${m(3)-22}`,fill:"none",stroke:"#38bdf8",strokeWidth:3,strokeLinejoin:"round"})]}),e.jsx("text",{x:x(3333),y:a-15,textAnchor:"middle",fill:"#a3e635",fontSize:18,fontFamily:"monospace",fontWeight:"bold",children:"36 BPM"}),e.jsx("text",{x:x(18333),y:a-15,textAnchor:"middle",fill:"#a3e635",fontSize:18,fontFamily:"monospace",fontWeight:"bold",children:"24 BPM"}),e.jsx("text",{x:x(45e3),y:a-15,textAnchor:"middle",fill:"#a3e635",fontSize:18,fontFamily:"monospace",fontWeight:"bold",children:"12 BPM"})]})}if(r==="all-or-none"){const te=w.periodMs+4e3,q=["Sub threshold","Threshold","Maximal","Supramaximal"];return e.jsx(e.Fragment,{children:q.map((I,d)=>{const b=x(d*te),V=d%2===1,p=V?35:75,F=V?50:90;return e.jsxs("g",{children:[e.jsx("text",{x:b,y:p,textAnchor:d===0?"start":"middle",fill:"#facc15",fontSize:22,fontFamily:"monospace",fontWeight:"bold",style:{filter:"drop-shadow(0 0 4px rgba(0,0,0,0.8))"},children:I}),e.jsx("line",{x1:d===0?b+10:b,y1:F,x2:d===0?b+10:b,y2:m(3)-12,stroke:"#facc15",strokeWidth:3}),e.jsx("path",{d:`M ${(d===0?b+10:b)-7} ${m(3)-24} L ${d===0?b+10:b} ${m(3)-10} L ${(d===0?b+10:b)+7} ${m(3)-24}`,fill:"none",stroke:"#facc15",strokeWidth:3})]},`all-none-${d}`)})})}return null})(),e.jsxs("text",{x:c-s.right-10,y:s.top+20,textAnchor:"end",fill:h,fontSize:14,fontFamily:"monospace",fontWeight:"bold",children:["HR: ",C," BPM"]}),e.jsxs("text",{x:c-s.right-10,y:s.top+40,textAnchor:"end",fill:v,fontSize:12,fontFamily:"monospace",children:["T: ",l,"°C"]}),t&&e.jsx("text",{x:s.left+10,y:s.top+20,fill:"#ef4444",fontSize:14,fontFamily:"monospace",fontWeight:"bold",children:"● REC"})]})},qe=({isPressed:i,onHoverChange:l})=>{const t=n.useRef(null);return he((r,j)=>{if(t.current){const C=i?.05:.2;t.current.rotation.z=We.lerp(t.current.rotation.z,C,j*10)}}),e.jsx(A,{label:"Tap Key (Stimulus)",onHoverChange:l,children:e.jsxs("group",{position:[2.8,-.68,.8],rotation:[0,-.2,0],children:[e.jsx(P,{args:[1.4,.12,.7],position:[0,.06,0],children:e.jsx("meshStandardMaterial",{color:"#111",roughness:.2,metalness:.1})}),e.jsxs("group",{position:[-.5,.12,.15],children:[e.jsxs(k,{args:[.05,.05,.02],position:[0,0,0],children:[" ",e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8})," "]}),e.jsx(k,{args:[.05,.07,.25],position:[0,.12,0],children:e.jsx("meshStandardMaterial",{color:"#1a1a1a",roughness:.3})}),e.jsxs(k,{args:[.02,.02,.05],position:[0,.26,0],children:[" ",e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8})," "]})]}),e.jsxs("group",{position:[.5,.12,.15],children:[e.jsxs(k,{args:[.05,.05,.02],position:[0,0,0],children:[" ",e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8})," "]}),e.jsx(k,{args:[.05,.07,.25],position:[0,.12,0],children:e.jsx("meshStandardMaterial",{color:"#1a1a1a",roughness:.3})}),e.jsxs(k,{args:[.02,.02,.05],position:[0,.26,0],children:[" ",e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8})," "]})]}),e.jsxs("group",{position:[-.4,.12,-.1],children:[e.jsx(P,{args:[.2,.01,.3],position:[0,0,0],children:e.jsx("meshStandardMaterial",{color:"#c0c0c0",metalness:.8})}),e.jsx(k,{args:[.02,.02,.05],position:[0,.02,0],children:e.jsx("meshStandardMaterial",{color:"#c0c0c0",metalness:.8})}),e.jsxs("group",{ref:t,rotation:[0,0,.2],children:[e.jsx(P,{args:[1.1,.015,.12],position:[.55,0,0],children:e.jsx("meshStandardMaterial",{color:"#e2e8f0",metalness:.7,roughness:.3})}),e.jsxs("group",{position:[1,.01,0],children:[e.jsx(k,{args:[.015,.015,.15],position:[0,.08,0],children:e.jsx("meshStandardMaterial",{color:"#111"})}),e.jsx(k,{args:[.15,.15,.08],position:[0,.16,0],children:e.jsx("meshStandardMaterial",{color:"#111",roughness:.6})}),e.jsx(k,{args:[.02,.02,.06],position:[0,-.04,0],children:e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8})})]})]})]}),e.jsxs("group",{position:[.6,.12,-.1],children:[e.jsx(P,{args:[.15,.01,.15],position:[0,0,0],children:e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8})}),e.jsx(k,{args:[.03,.03,.06],position:[0,.03,0],children:e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8})})]}),e.jsx(O,{args:[new X([new o(-.5,.12,.15),new o(-.6,.12,.3)]),8,.01,8,!1],children:e.jsx("meshStandardMaterial",{color:"#333"})}),e.jsx(O,{args:[new X([new o(.5,.12,.15),new o(.6,.12,.3)]),8,.01,8,!1],children:e.jsx("meshStandardMaterial",{color:"#333"})})]})})},Qe=({onBack:i})=>{const[l,t]=n.useState(25),[r,j]=n.useState("heart-block"),[C,h]=n.useState(null),[g,v]=n.useState(0),[N,c]=n.useState(2.5),[a,s]=n.useState("3d"),[D,z]=n.useState(!1),[T,K]=n.useState(!1),[m,re]=n.useState(0),[oe,U]=n.useState(!1),[f,R]=n.useState({time:0,isRecording:!1,data:[],currentContraction:3,heartRate:24,temperature:25}),B=n.useRef(),x=n.useRef(0),G=n.useRef([]),ie=20,Y=n.useRef(0),ne=n.useRef(l),{ensureAudioContext:ae}=$e({isRecording:f.isRecording,phase:m,volume:1,muted:T,silent:oe});n.useEffect(()=>{ne.current=l},[l]),n.useEffect(()=>{c(r==="heart-block"?1:r==="all-or-none"?1.5:2.5)},[r]);const le=()=>{f.isRecording||(ae(),G.current=[],Y.current=0,R({time:0,isRecording:!0,data:[],currentContraction:3,heartRate:ee(l,r).hr,temperature:l}),v(W=>W+1),x.current=0)},w=()=>{R(W=>({...W,isRecording:!1})),B.current&&cancelAnimationFrame(B.current)},_=()=>{G.current=[],Y.current=0,R({time:0,isRecording:!1,data:[],currentContraction:3,heartRate:ee(l,r).hr,temperature:l}),v(W=>W+1),B.current&&cancelAnimationFrame(B.current)};return n.useEffect(()=>{if(!f.isRecording){R(u=>({...u,heartRate:ee(l,r).hr}));return}let W=Date.now(),S=0;x.current=Date.now();const M=()=>{const u=Date.now(),L=u-W;W=u,S+=L;const E=ee(ne.current,r);let y=0,$=0,Z=E.hr;if(r==="heart-block"){const d=1666.6666666666667,b=8,V=b*d,p=60/24*1e3,F=8,de=V+F*p;if(S<V)y=Math.floor(S/d),$=S%d/d,Z=36;else if(S<de){const Q=S-V;y=b+Math.floor(Q/p),$=Q%p/p,Z=24}else{const ce=S-de;y=b+F+Math.floor(ce/5e3),$=ce%5e3/5e3,Z=12}if(y>=25){R(Q=>({...Q,isRecording:!1}));return}}else if(r==="all-or-none"){const d=E.periodMs,V=d+4e3;y=Math.floor(S/V);const p=S%V;if(p<d?$=p/d:$=-1,y>=4){R(F=>({...F,isRecording:!1}));return}}else{y=Math.floor(S/E.periodMs),$=S%E.periodMs/E.periodMs;let d=10;if(r==="summation"&&(d=5),y>=d){R(b=>({...b,isRecording:!1}));return}}const te=ze($,E.amplitude,y,r),q=Math.max(0,te);re($);let I=!1;r==="heart-block"?I=y>=4&&y<=7||y>=12&&y<=15:r==="summation"?I=y>=1&&y<=3||y>=6:r==="all-or-none"&&(I=y===0||$<0),U(I),S-Y.current>=ie&&(Y.current=S,G.current.push({t:S,y:te})),R(d=>({...d,time:S,currentContraction:q,heartRate:Z,data:G.current,ligature1:r==="heart-block"&&y>=4,ligature2:r==="heart-block"&&y>=12})),B.current=requestAnimationFrame(M)};return B.current=requestAnimationFrame(M),()=>{B.current&&cancelAnimationFrame(B.current)}},[f.isRecording]),e.jsxs("div",{className:"flex flex-col h-screen bg-slate-950 text-slate-100 font-sans",children:[e.jsx("header",{className:"flex items-center justify-between px-6 py-4 bg-slate-900 border-b border-slate-800",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:i,className:"p-2 hover:bg-slate-800 rounded-lg text-slate-400",children:e.jsx(ge,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-red-400 to-pink-500 bg-clip-text text-transparent",children:"Properties of Cardiac Muscle"}),e.jsx("p",{className:"text-slate-400 text-xs",children:"Amphibian / Frog Heart — Effect of Temperature"})]})]})}),e.jsxs("main",{className:"flex-1 flex flex-col lg:flex-row overflow-hidden",children:[e.jsxs("div",{className:"lg:hidden flex bg-slate-800 border-b border-slate-700",children:[e.jsxs("button",{onClick:()=>s("3d"),className:`flex-1 py-3 px-4 flex items-center justify-center gap-2 font-medium transition-all ${a==="3d"?"bg-slate-900 text-red-400 border-b-2 border-red-400":"text-slate-400 hover:text-slate-200"}`,children:[e.jsx(pe,{className:"w-4 h-4"}),e.jsx("span",{children:"3D View"})]}),e.jsxs("button",{onClick:()=>s("graph"),className:`flex-1 py-3 px-4 flex items-center justify-center gap-2 font-medium transition-all ${a==="graph"?"bg-slate-900 text-red-400 border-b-2 border-red-400":"text-slate-400 hover:text-slate-200"}`,children:[e.jsx(je,{className:"w-4 h-4"}),e.jsx("span",{children:"Cardiogram"})]})]}),e.jsxs("div",{className:`flex-1 relative bg-black ${a==="graph"?"hidden lg:flex":"flex"}`,children:[e.jsxs(be,{shadows:!0,camera:{position:[-3.82,2.79,-4.95],fov:38},children:[e.jsx("color",{attach:"background",args:["#0f172a"]}),e.jsx(Se,{preset:"city"}),e.jsx("ambientLight",{intensity:.6,color:"#ffffff"}),e.jsx("spotLight",{position:[10,10,5],angle:.3,penumbra:.5,intensity:2,castShadow:!0}),e.jsx("pointLight",{position:[-5,5,-3],intensity:.5,color:"#ffeedd"}),e.jsx("group",{position:[0,-1.2,0],children:e.jsxs("group",{position:[-.5,0,0],children:[e.jsxs("group",{rotation:[0,-Math.PI*.5,0],position:[-.01,-.84,.25],children:[e.jsx(Be,{onHoverChange:h}),e.jsx("group",{position:[-.2,0,0],rotation:[0,-Math.PI/2,0],children:e.jsx(Ie,{onHoverChange:h})}),e.jsx("group",{position:[.3,.48,0],rotation:[0,-Math.PI/2,0],children:e.jsx(_e,{contraction:f.currentContraction,temperature:l,onHoverChange:h,showLigature1:!!f.ligature1,isTight1:f.ligature1,showLigature2:!!f.ligature2,isTight2:f.ligature2})})]}),e.jsx(Oe,{contraction:f.currentContraction}),e.jsx(Ge,{angle:(3-f.currentContraction)*.036,onHoverChange:h}),r==="summation"&&e.jsx(qe,{isPressed:f.isRecording&&(()=>{const S=ee(l,r).periodMs,M=S*2,u=S*4,L=f.time<150,E=f.time>M&&f.time<M+150,y=u-1300,$=u,Z=f.time>y&&f.time<$&&f.time%250<100;return L||E||Z})(),onHoverChange:h}),e.jsx("group",{position:[4.395,.75,.05],children:e.jsx(Ue,{simTime:f.time,waveformValue:f.currentContraction,isRecording:f.isRecording,onHoverChange:h,resetKey:g,drumSpeed:N})})]})}),e.jsx(Me,{makeDefault:!0,target:[.2,-.36,-.44],minPolarAngle:0})]}),C&&e.jsx("div",{className:"absolute top-4 left-4 bg-slate-900/90 text-white px-3 py-1.5 rounded-full text-sm border border-slate-700 backdrop-blur-sm pointer-events-none animate-in fade-in duration-200",children:C})]}),e.jsxs("div",{className:"w-full lg:w-[450px] bg-slate-900 border-l border-slate-800 flex flex-col flex-1 lg:flex-none",children:[e.jsxs("div",{className:`flex-1 p-4 min-h-0 flex flex-col border-b border-slate-800 ${a==="3d"?"hidden lg:flex":"flex"}`,children:[e.jsx("h3",{className:"text-slate-400 text-sm font-bold uppercase tracking-wider mb-2",children:"Oscilloscope View"}),e.jsx("div",{className:"flex-1 bg-slate-950 rounded-lg border border-slate-800 overflow-hidden relative",children:e.jsx(Ye,{data:f.data,temperature:l,isRecording:f.isRecording,selectedExperiment:r,drumSpeed:N,heartRate:f.heartRate})})]}),e.jsxs("div",{className:"p-4 lg:p-6 bg-slate-900 z-10 space-y-4 overflow-y-auto",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-bold text-slate-400 uppercase flex items-center gap-2 mb-2",children:[e.jsx(ye,{className:"w-4 h-4 text-emerald-400"})," Select Experiment"]}),e.jsxs("select",{value:r,onChange:W=>{const S=W.target.value;j(S),G.current=[],Y.current=0,R({time:0,isRecording:!1,data:[],currentContraction:3,heartRate:ee(l,S).hr,temperature:l}),v(M=>M+1),B.current&&cancelAnimationFrame(B.current)},className:"w-full bg-slate-800 border border-slate-700 text-slate-200 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block p-2.5 outline-none",children:[e.jsx("option",{value:"extra-systole",children:"1. Extra systole and compensatory pause"}),e.jsx("option",{value:"heart-block",children:"2. Heart block: Stannius ligatures"}),e.jsx("option",{value:"all-or-none",children:"3. All or none law"}),e.jsx("option",{value:"staircase",children:"4. Stair case phenomenon"}),e.jsx("option",{value:"summation",children:"5. Summation of subliminal stimuli"})]})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg border border-slate-700 p-3 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full animate-pulse bg-emerald-500"}),e.jsx("span",{className:"text-sm text-slate-300",children:"Heart Rate"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-lg font-mono font-bold text-emerald-400",children:[f.heartRate," bpm"]}),e.jsx("button",{onClick:()=>{ae(),K(W=>!W)},className:`p-1.5 rounded-lg transition-all border ${T?"bg-slate-700 border-slate-600 text-slate-500":"bg-red-900/40 border-red-700/50 text-red-400 hover:bg-red-900/60"}`,title:T?"Unmute heartbeat sound":"Mute heartbeat sound",children:T?e.jsx(Ae,{className:"w-4 h-4"}):e.jsx(Te,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"bg-slate-800 p-3 rounded-lg border border-slate-700",children:[e.jsxs("div",{className:"flex justify-between mb-1.5",children:[e.jsxs("label",{className:"text-xs font-bold text-slate-400 uppercase flex items-center gap-1.5",children:[e.jsx(Fe,{className:"w-3.5 h-3.5 text-cyan-400"})," Drum Speed"]}),e.jsxs("span",{className:"text-cyan-400 font-mono text-sm",children:[N," mm/s"]})]}),e.jsx("input",{type:"range",min:"1",max:"10",step:"0.5",value:N,onChange:W=>c(Number(W.target.value)),disabled:r==="heart-block"||r==="all-or-none",className:`w-full h-2 rounded-lg appearance-none cursor-pointer accent-cyan-500 ${r==="heart-block"||r==="all-or-none"?"opacity-50 cursor-not-allowed bg-slate-700":"bg-slate-600"}`}),e.jsxs("div",{className:"flex justify-between text-[10px] text-slate-500 mt-1",children:[e.jsx("span",{children:"1 mm/s"}),e.jsx("span",{children:"10 mm/s"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[f.isRecording?e.jsxs("button",{onClick:w,className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white font-bold py-3 rounded-xl transition-all flex items-center justify-center gap-2",children:[e.jsx(De,{className:"w-5 h-5"})," Stop"]}):e.jsxs("button",{onClick:le,className:"flex-1 bg-red-600 hover:bg-red-500 text-white font-bold py-3 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2",children:[e.jsx(Ve,{className:"w-5 h-5"})," Start Recording"]}),e.jsxs("button",{onClick:_,className:"px-6 bg-slate-800 hover:bg-slate-700 text-slate-300 font-bold py-3 rounded-xl transition-all border border-slate-700 flex items-center justify-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"})," Reset"]})]})]})]})]})]})};export{Qe as PropertiesOfCardiacMuscle};
