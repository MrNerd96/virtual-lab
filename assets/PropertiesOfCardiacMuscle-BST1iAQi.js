import{r as l,j as e,A as ge,d as pe,L as je,b as be,E as Se,O as Me,i as ye,l as we,B as P,C as S,S as J,n as de,a as ke,u as le,W as ve,x as ne,X as Re,k as _,V as r,a1 as Ce,a2 as Pe,T as I,Y as Le,$ as ue,g as Ee,a0 as We,e as $e}from"./index-D_FyITXq.js";import{D as Ae,S as Ne}from"./square-CTkr2khy.js";import{P as Te}from"./play-BIVzEl8I.js";const ce=[{label:"Cold (15°C)",value:15,hr:18,amplitude:1.3,color:"#3b82f6",bgColor:"bg-blue-600",borderColor:"border-blue-400"},{label:"Normal (25°C)",value:25,hr:24,amplitude:1,color:"#22c55e",bgColor:"bg-green-600",borderColor:"border-green-400"},{label:"Warm (35°C)",value:35,hr:36,amplitude:.7,color:"#ef4444",bgColor:"bg-red-600",borderColor:"border-red-400"}];function te(a,i){const t=ce.find(v=>v.value===a)||ce[1],o=i==="heart-block"?36:t.hr,p=60/o*1e3;return{hr:o,amplitude:t.amplitude,periodMs:p,color:t.color}}function Fe(a,i,t=0,o="extra-systole"){const p=m=>(1-Math.cos(m*Math.PI))/2,v=m=>m<.16?3-2*p(m/.16):m<.32?1+1*p((m-.16)/.16):m<.4?2:m<.56?2-2*p((m-.4)/.16):3*p((m-.56)/.44);let h;if(o==="extra-systole")if(t===2)a<.16?h=3-5*p(a/.16):a<.32?h=-2+5*p((a-.16)/.16):(a<.4||a<.56,h=3);else{h=v(a);const m={3:1/3,4:5/9,5:7/9,6:1};if(t in m){const M=m[t];h=3-(3-h)*M}}else if(o==="staircase"){const m={0:.4,1:.6,2:.8,3:.9};h=v(a);const M=m[t]??1;h=3-(3-h)*M}else o==="summation"?t>=1&&t<=3||t>=6?h=3:h=v(a):o==="heart-block"?t>=4&&t<=7||t>=12&&t<=15?h=3:h=v(a):o==="all-or-none"?(t===0||a<0?h=3:h=v(a),t===0&&a>=0&&a<.02&&(h-=.6)):h=v(a);return h*i}const W=({label:a,children:i,onHoverChange:t})=>e.jsx("group",{onPointerOver:o=>{t&&(o.stopPropagation(),t(a),document.body.style.cursor="pointer")},onPointerOut:()=>{t&&(t(null),document.body.style.cursor="auto")},children:i}),De=({onHoverChange:a})=>e.jsx(W,{label:"Myograph Board",onHoverChange:a,children:e.jsxs("group",{position:[0,-.9,0],children:[e.jsx(P,{args:[4,.15,2.5],position:[0,0,0],children:e.jsx("meshStandardMaterial",{color:"#8B7355",roughness:.8})}),e.jsx(P,{args:[3.6,.05,2.1],position:[0,.1,0],children:e.jsx("meshStandardMaterial",{color:"#D2B48C",roughness:.9})}),[[-1.7,-.2,-1],[1.7,-.2,-1],[-1.7,-.2,1],[1.7,-.2,1]].map((i,t)=>e.jsx(S,{args:[.06,.08,.3],position:i,children:e.jsx("meshStandardMaterial",{color:"#5C4033",roughness:.7})},`leg-${t}`)),[[-1.2,.15,-.6],[-1.2,.15,.6],[1.2,.15,-.6],[1.2,.15,.6],[-.6,.15,-.8],[-.6,.15,.8],[.6,.15,-.8],[.6,.15,.8]].map((i,t)=>e.jsxs("group",{position:i,children:[e.jsx(S,{args:[.015,.015,.15],position:[0,.075,0],children:e.jsx("meshStandardMaterial",{color:"#c0c0c0",metalness:.9,roughness:.1})}),e.jsx(J,{args:[.02,8,8],position:[0,.15,0],children:e.jsx("meshStandardMaterial",{color:"#e0e0e0",metalness:.8,roughness:.2})})]},`pin-${t}`))]})}),Be=({contraction:a,temperature:i,onHoverChange:t,showLigature1:o,isTight1:p,showLigature2:v,isTight2:h})=>{const m=l.useRef(null),M=l.useRef(null),E=l.useRef(null),c=l.useRef(null),n=l.useRef(null),s=l.useRef(null),N=l.useRef(null),F=l.useRef(null),u=l.useMemo(()=>i<=15?"#8B0000":i>=35?"#FF4444":"#be123c",[i]),D=l.useMemo(()=>new ke(u).multiplyScalar(.8).getHexString(),[u]);le(()=>{if(M.current){const R=3-a,g=Math.max(.4,1-R*.05),j=Math.max(.5,1-R*.05);if(M.current.scale.set(g,j,g),s.current){const V=-.3*j;s.current.position.set(0,V,.05*g),s.current.scale.set(g,1,g)}const A=Math.max(.8,1-R*.04);N.current&&N.current.scale.set(A,A,A),F.current&&F.current.scale.set(A*(p?.9:1.05),A*(p?.9:1.05),1)}if(E.current&&c.current&&(E.current.scale.set(1,1,1),c.current.scale.set(1,1,1)),n.current){const g=1+(3-a)*.05;n.current.scale.set(g,1,g)}});const d=l.useMemo(()=>{const R=new ve([new ne(0,-.6),new ne(.15,-.4),new ne(.28,-.1),new ne(.32,.2),new ne(.25,.5),new ne(.15,.6),new ne(0,.65)]),g=new Re(R.getPoints(20),32);return g.computeVertexNormals(),g},[]),se=l.useMemo(()=>new _([new r(0,.6,.1),new r(0,.85,.15)]),[]),K=l.useMemo(()=>new _([new r(0,.85,.15),new r(-.25,1,.05),new r(-.4,1.05,-.1)]),[]),H=l.useMemo(()=>new _([new r(0,.85,.15),new r(.25,1,.05),new r(.4,1.05,-.1)]),[]),$=.18,L=.18,ae=.12,x=.3,Z=0,T=l.useMemo(()=>new _([new r(-.4,.6,.1),new r(-.3,.4,.15),new r(-$,Z+L-.05,x)]),[]),k=l.useMemo(()=>new _([new r(.4,.6,.1),new r(.3,.4,.15),new r($,Z+L-.05,x)]),[]),Y=l.useMemo(()=>new _([new r(0,Z-L+.05,x),new r(0,-.6,.1),new r(0,-.7,.1)]),[]),q=l.useMemo(()=>{const R=new Ce,g=$,j=L,A=ae;R.moveTo(-g+A,-j),R.lineTo(g-A,-j),R.quadraticCurveTo(g,-j,g-.06,-j+.1),R.lineTo(.06,j-.1),R.quadraticCurveTo(0,j,-.06,j-.1),R.lineTo(-g+.06,-j+.1),R.quadraticCurveTo(-g,-j,-g+A,-j);const V={depth:.08,bevelEnabled:!0,bevelSegments:8,steps:2,bevelSize:.05,bevelThickness:.05},z=new Pe(R,V);return z.center(),z},[]),re=l.useMemo(()=>{const R=$+.08,g=L+.08,j=[new r(0,-g,0),new r(R-.1,-g,0),new r(R,-g+.1,0),new r(R-.05,0,0),new r(0,g+.02,0),new r(-.21000000000000002,0,0),new r(-R,-g+.1,0),new r(-.16,-g,0)];return new _(j,!0)},[]),f=l.useMemo(()=>new _([new r(0,L+.08,0),new r(.08,L+.18,.1),new r(.12,L+.28,.15)]),[]),y=l.useMemo(()=>new _([new r(0,L+.08,0),new r(-.08,L+.18,.1),new r(-.12,L+.28,.15)]),[]),X=l.useMemo(()=>new _([new r(.21,0,0),new r(.35,.1,.05),new r(.4,.2,.1)]),[]),B=l.useMemo(()=>new _([new r(.21,0,0),new r(.35,-.1,.05),new r(.4,-.2,.1)]),[]);return e.jsx(W,{label:"Frog Heart (Sinus Venosus → Atria → Ventricle)",onHoverChange:t,children:e.jsxs("group",{ref:m,position:[0,-.2,0],rotation:[0,0,Math.PI],children:[e.jsxs("group",{position:[0,.55,0],children:[e.jsx("group",{ref:c,position:[.18,0,-.05],rotation:[0,0,-.2],children:e.jsx(W,{label:"Right Atrium",onHoverChange:t,children:e.jsx(J,{args:[.22,32,32],scale:[1,1.1,.9],children:e.jsx("meshPhysicalMaterial",{color:"#"+D,roughness:.4,metalness:.1,clearcoat:1,clearcoatRoughness:.2})})})}),e.jsx("group",{ref:E,position:[-.18,.05,-.05],rotation:[0,0,.2],children:e.jsx(W,{label:"Left Atrium",onHoverChange:t,children:e.jsx(J,{args:[.16,32,32],scale:[1,1.1,.9],children:e.jsx("meshPhysicalMaterial",{color:"#"+D,roughness:.4,metalness:.1,clearcoat:1,clearcoatRoughness:.2})})})})]}),e.jsx("group",{ref:M,position:[0,0,.05],children:e.jsx(W,{label:"Ventricle",onHoverChange:t,children:e.jsx("mesh",{geometry:d,children:e.jsx("meshPhysicalMaterial",{color:u,roughness:.5,metalness:.1,clearcoat:1,clearcoatRoughness:.3})})})}),e.jsx("group",{ref:n,children:e.jsxs(W,{label:"Truncus Arteriosus (Branching)",onHoverChange:t,children:[e.jsx(I,{args:[se,16,.06,12,!1],children:e.jsx("meshPhysicalMaterial",{color:"#d64949",roughness:.4,clearcoat:1})}),e.jsx(I,{args:[K,16,.045,8,!1],children:e.jsx("meshPhysicalMaterial",{color:"#d64949",roughness:.4,clearcoat:1})}),e.jsx(I,{args:[H,16,.045,8,!1],children:e.jsx("meshPhysicalMaterial",{color:"#d64949",roughness:.4,clearcoat:1})})]})}),e.jsxs(W,{label:"Vena Cavae",onHoverChange:t,children:[e.jsx(I,{args:[T,12,.035,8,!1],children:e.jsx("meshPhysicalMaterial",{color:"#5e4b8b",roughness:.6})}),e.jsx(I,{args:[k,12,.035,8,!1],children:e.jsx("meshPhysicalMaterial",{color:"#5e4b8b",roughness:.6})}),e.jsx(I,{args:[Y,12,.035,8,!1],children:e.jsx("meshPhysicalMaterial",{color:"#5e4b8b",roughness:.6})})]}),e.jsx(W,{label:"Sinus Venosus (Posterior)",onHoverChange:t,children:e.jsx("mesh",{ref:N,geometry:q,position:[0,Z,x],rotation:[0,0,Math.PI],children:e.jsx("meshPhysicalMaterial",{color:"#4a2c2c",roughness:.8})})}),o&&e.jsx(W,{label:"1st Stannius Ligature",onHoverChange:t,children:e.jsxs("group",{ref:F,position:[0,Z,x],rotation:[0,0,Math.PI],children:[e.jsx(I,{args:[re,64,p?.025:.035,8,!0],scale:[p?.9:1.05,p?.9:1.05,1],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})}),e.jsx(J,{args:[.05,8,8],position:[0,L+.08,0],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})}),e.jsx(I,{args:[f,12,.025,6,!1],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})}),e.jsx(I,{args:[y,12,.025,6,!1],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})})]})}),v&&e.jsx(W,{label:"2nd Stannius Ligature",onHoverChange:t,children:e.jsxs("group",{ref:s,position:[0,-.3,.05],children:[e.jsx(de,{args:[.2,.03,8,24],rotation:[Math.PI/2,0,0],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})}),e.jsx(J,{args:[.05,8,8],position:[.21,0,0],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})}),e.jsx(I,{args:[X,12,.02,6,!1],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})}),e.jsx(I,{args:[B,12,.02,6,!1],children:e.jsx("meshStandardMaterial",{color:"#ffffff",roughness:.9})})]})})]})})},Ve=({onHoverChange:a})=>e.jsx(W,{label:"Frog (Pithed)",onHoverChange:a,children:e.jsxs("group",{position:[0,-.4,.2],rotation:[-.1,0,0],children:[e.jsx(J,{args:[.5,32,32],scale:[2.2,1,3],position:[0,0,0],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})}),e.jsxs("group",{position:[0,.45,-.5],rotation:[.1,0,0],children:[e.jsx(de,{args:[.28,.05,16,24],rotation:[Math.PI/2,0,0],scale:[1,1,1.2],position:[0,.02,0],children:e.jsx("meshStandardMaterial",{color:"#661111",roughness:.5})}),e.jsxs("group",{position:[-.4,.02,0],rotation:[0,0,.3],children:[e.jsx(P,{args:[.3,.03,.6],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})}),e.jsx(P,{args:[.28,.031,.58],position:[.05,-.005,0],children:e.jsx("meshStandardMaterial",{color:"#4a1c1c",roughness:.7})})]}),e.jsxs("group",{position:[.4,.02,0],rotation:[0,0,-.3],children:[e.jsx(P,{args:[.3,.03,.6],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})}),e.jsx(P,{args:[.28,.031,.58],position:[-.05,-.005,0],children:e.jsx("meshStandardMaterial",{color:"#4a1c1c",roughness:.7})})]}),e.jsxs("group",{position:[0,.05,-.4],rotation:[.4,0,0],children:[e.jsx(P,{args:[.5,.03,.25],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})}),e.jsx(P,{args:[.48,.031,.23],position:[0,-.005,.05],children:e.jsx("meshStandardMaterial",{color:"#4a1c1c",roughness:.7})})]}),e.jsxs("group",{position:[0,.05,.4],rotation:[-.4,0,0],children:[e.jsx(P,{args:[.5,.03,.25],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})}),e.jsx(P,{args:[.48,.031,.23],position:[0,-.005,-.05],children:e.jsx("meshStandardMaterial",{color:"#4a1c1c",roughness:.7})})]})]}),e.jsxs("group",{position:[0,.1,-1.6],children:[e.jsx(J,{args:[.4,32,32],scale:[1.5,.8,1.2],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})}),e.jsx(J,{args:[.1,16,16],position:[.3,.2,-.1],children:e.jsx("meshStandardMaterial",{color:"#111",roughness:.2})}),e.jsx(J,{args:[.1,16,16],position:[-.3,.2,-.1],children:e.jsx("meshStandardMaterial",{color:"#111",roughness:.2})})]}),e.jsx("group",{position:[.9,-.1,1],rotation:[0,.5,0],children:e.jsx(S,{args:[.2,.15,1.2],rotation:[0,0,1.2],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})})}),e.jsx("group",{position:[-.9,-.1,1],rotation:[0,-.5,0],children:e.jsx(S,{args:[.2,.15,1.2],rotation:[0,0,-1.2],children:e.jsx("meshStandardMaterial",{color:"#556b2f",roughness:.6})})}),e.jsx("group",{position:[.8,-.1,-.8],rotation:[0,-.3,0],children:e.jsx(S,{args:[.12,.1,1],rotation:[0,0,1.3],children:e.jsx("meshStandardMaterial",{color:"#8da399",roughness:.8})})}),e.jsx("group",{position:[-.8,-.1,-.8],rotation:[0,.3,0],children:e.jsx(S,{args:[.12,.1,1],rotation:[0,0,-1.3],children:e.jsx("meshStandardMaterial",{color:"#8da399",roughness:.8})})})]})}),ze=({length:a,radius:i,coils:t,color:o,thickness:p})=>{const h=l.useMemo(()=>{const m=[],M=t*12;for(let c=0;c<=M;c++){const n=c/M,s=n*Math.PI*2*t,N=i*Math.cos(s),F=i*Math.sin(s),u=-n*1;m.push(new r(N,u,F))}const E=new _(m);return new We(E,M,p,8,!1)},[i,t,p]);return e.jsx("group",{scale:[1,a/1,1],children:e.jsx("mesh",{geometry:h,children:e.jsx("meshStandardMaterial",{color:o,metalness:.6,roughness:.4})})})},_e=({angle:a,onHoverChange:i})=>{const t="#e2e8f0",o="#94a3b8",p="#475569",v="#f1f5f9",M=[-1.5,.7,.15],E=-a,n=.75+a*.9,s=[.6,0,0];return e.jsxs("group",{position:[0,.5,.5],children:[e.jsx(W,{label:"Starling Lever (Stand Post)",onHoverChange:i,children:e.jsx(S,{args:[.06,.06,4.5],position:[-1.5,0,0],children:e.jsx("meshStandardMaterial",{color:o,metalness:.6,roughness:.4})})}),e.jsx(W,{label:"Starling Lever (Tension Adjuster)",onHoverChange:i,children:e.jsxs("group",{position:[-.75,.4,0],rotation:[0,0,1.57],children:[e.jsx(S,{args:[.025,.025,1],position:[.8,.05,0],rotation:[0,0,Math.PI/2],children:e.jsx("meshStandardMaterial",{color:t,metalness:.6})}),e.jsxs("group",{position:[1.1,.05,0],children:[e.jsx(P,{args:[.1,.15,.1],children:e.jsx("meshStandardMaterial",{color:t})}),e.jsx(S,{args:[.015,.015,.6],position:[0,-.17,0],children:e.jsx("meshStandardMaterial",{color:t,metalness:.5})}),e.jsx(S,{args:[.05,.05,.04],position:[0,.13,0],children:e.jsx("meshStandardMaterial",{color:p,roughness:.8})}),e.jsx(de,{args:[.025,.005,8,16],position:[0,-.47,0],rotation:[Math.PI/2,0,0],children:e.jsx("meshStandardMaterial",{color:t})})]})]})}),e.jsxs("group",{position:M,children:[e.jsxs("group",{position:[.3,0,-.14],children:[e.jsx(W,{label:"Starling Lever (Mounting Clamp)",onHoverChange:i,children:e.jsxs("group",{children:[e.jsx(P,{args:[.85,.13,.4],children:e.jsx("meshStandardMaterial",{color:t,metalness:.7})}),e.jsxs("group",{position:[-.5,0,0],rotation:[0,0,Math.PI/2],children:[e.jsx(S,{args:[.03,.03,.1],children:e.jsx("meshStandardMaterial",{color:p})}),e.jsx(S,{args:[.07,.07,.02],position:[0,.05,0],children:e.jsx("meshStandardMaterial",{color:p})})]})]})}),e.jsxs("group",{position:[.55,0,0],children:[e.jsx(P,{args:[.05,.13,.35],position:[-.1,0,0],children:e.jsx("meshStandardMaterial",{color:t,metalness:.7})}),e.jsx(P,{args:[.25,.13,.04],position:[0,0,.18],children:e.jsx("meshStandardMaterial",{color:t,metalness:.7})}),e.jsx(P,{args:[.25,.13,.04],position:[0,0,-.18],children:e.jsx("meshStandardMaterial",{color:t,metalness:.7})})]}),e.jsxs("group",{rotation:[0,0,E],position:s,children:[e.jsx(S,{args:[.02,.02,.35],rotation:[Math.PI/2,0,0],children:e.jsx("meshStandardMaterial",{color:p})}),e.jsx(W,{label:"Starling Lever (Lever Arm)",onHoverChange:i,children:e.jsxs("group",{position:[.5,0,0],children:[e.jsx(P,{args:[1.2,.12,.03],children:e.jsx("meshStandardMaterial",{color:v,roughness:.3,metalness:.2})}),[-.4,-.2,0,.2,.4].map((N,F)=>e.jsx("group",{position:[N,0,0],rotation:[Math.PI/2,0,0],children:e.jsx(S,{args:[.025,.025,.032],children:e.jsx("meshBasicMaterial",{color:"#1e293b"})})},F))]})}),e.jsx(W,{label:"Starling Lever (Writing Stylus)",onHoverChange:i,children:e.jsxs("group",{position:[1.18,0,0],children:[e.jsx(P,{args:[.08,.08,.08],position:[-.04,0,0],children:e.jsx("meshStandardMaterial",{color:t})}),e.jsx(S,{args:[.012,.012,2.9],position:[1.45,0,0],rotation:[0,0,Math.PI/2],children:e.jsx("meshStandardMaterial",{color:"#222",roughness:.6})}),e.jsx(ue,{args:[.012,.06,8],position:[2.9,0,0],rotation:[0,0,-Math.PI/2],children:e.jsx("meshStandardMaterial",{color:"#111"})})]})})]})]}),e.jsx(W,{label:"Starling Lever (Spring)",onHoverChange:i,children:e.jsx("group",{position:[1.15,.8,-.15],children:e.jsx(ze,{length:n,radius:.04,coils:14,color:"#cbd5e1",thickness:.01})})})]})]})},Ie=({contraction:a})=>{const{start:t,end:o,len:p,midpoint:v,quaternion:h}=l.useMemo(()=>{const s=-((3-a)*.036),N=1.16+Math.sin(s)*1,F=new r(0,.06-(3-a)*.03,0),u=new r(0,N,0),D=F.distanceTo(u),d=new r().addVectors(F,u).multiplyScalar(.5),se=new r(0,1,0),K=new r().subVectors(u,F).normalize(),H=new Le().setFromUnitVectors(se,K);return{start:F,end:u,len:D,midpoint:d,quaternion:H}},[a]),m=l.useMemo(()=>new _([new r(0,-.015,0),new r(0,-.12,0),new r(-.01,-.14,0),new r(-.04,-.14,0),new r(-.05,-.1,0)]),[]);return e.jsxs("group",{position:[0,.1,.5],children:[e.jsxs("mesh",{position:v,quaternion:h,scale:[1,p,1],children:[e.jsx("cylinderGeometry",{args:[.003,.003,1,8]}),e.jsx("meshStandardMaterial",{color:"#f0f0f0",roughness:.5})]}),e.jsxs("group",{position:t,rotation:[0,0,.1],children:[e.jsx(de,{args:[.015,.003,8,16],rotation:[0,Math.PI/2,0],children:e.jsx("meshStandardMaterial",{color:"#888",metalness:.8,roughness:.2})}),e.jsx(I,{args:[m,32,.003,8,!1],children:e.jsx("meshStandardMaterial",{color:"#888",metalness:.8,roughness:.2})}),e.jsx(S,{args:[.001,.003,.02],position:[-.052,-.09,0],rotation:[0,0,-.2],children:e.jsx("meshStandardMaterial",{color:"#888",metalness:.8,roughness:.2})}),e.jsx(ue,{args:[.002,.01,8],position:[-.052,-.1,0],rotation:[0,0,2.8],children:e.jsx("meshStandardMaterial",{color:"#888",metalness:.8,roughness:.2})})]})]})},Xe=({simTime:a,waveformValue:i,isRecording:t,onHoverChange:o,resetKey:p,drumSpeed:v})=>{const h=l.useRef(document.createElement("canvas")),m=l.useRef(null),M=l.useMemo(()=>{const c=h.current;c.width=2048,c.height=512;const n=c.getContext("2d");if(n){n.fillStyle="#1a1a1a",n.fillRect(0,0,2048,512),n.fillStyle="#0d0d0d";for(let s=0;s<200;s++)n.fillRect(Math.random()*2048,Math.random()*512,Math.random()*4,Math.random()*4)}return new Ee(c)},[]);l.useEffect(()=>{const c=h.current.getContext("2d");if(c){c.fillStyle="#1a1a1a",c.fillRect(0,0,2048,512),c.fillStyle="#0d0d0d";for(let n=0;n<200;n++)c.fillRect(Math.random()*2048,Math.random()*512,Math.random()*4,Math.random()*4);M.needsUpdate=!0}m.current=null},[p,M]),le(()=>{if(!t){m.current=null;return}const c=h.current.getContext("2d");if(!c)return;const s=80+a/1e3*v*15,N=512*.5-i*30;m.current&&(c.strokeStyle="#ffffff",c.lineWidth=2.5,c.shadowColor="#ffffff",c.shadowBlur=1,c.beginPath(),c.moveTo(m.current.x,m.current.y),c.lineTo(s,N),c.stroke(),c.shadowBlur=0,M.needsUpdate=!0),m.current={x:s,y:N}});const E=l.useRef(null);return le(()=>{if(E.current&&t){const s=(80+a/1e3*v*15-80)/2048*(2*Math.PI),N=1.8+Math.PI;E.current.rotation.y=N-s}}),e.jsx(W,{label:"Kymograph Drum",onHoverChange:o,children:e.jsxs("group",{position:[0,0,0],children:[e.jsx("group",{ref:E,rotation:[0,1.8+Math.PI,0],children:e.jsxs(S,{args:[1,1,2.5,64],children:[e.jsx("meshBasicMaterial",{attach:"material-0",map:M}),e.jsx("meshStandardMaterial",{attach:"material-1",color:"#111"}),e.jsx("meshStandardMaterial",{attach:"material-2",color:"#111"})]})}),e.jsx(S,{args:[.06,.06,3.5],position:[0,-.15,0],children:e.jsx("meshStandardMaterial",{color:"#1e293b",metalness:.8})}),e.jsx(P,{args:[1.2,.45,1.5],position:[0,-1.75,0],children:e.jsx("meshStandardMaterial",{color:"#0f172a",metalness:.3,roughness:.6})})]})})},Ge=({data:a,temperature:i,isRecording:t,selectedExperiment:o,drumSpeed:p,heartRate:v})=>{ce.find(f=>f.value===i)||ce[1];const h="#4ade80",m="#14532d",M="#166534",E="#020617",c=900,n=320,s={top:110,right:20,bottom:40,left:40},N=c-s.left-s.right,F=n-s.top-s.bottom,u=-2.5,D=3.5,d=f=>s.top+F-(f-u)/(D-u)*F,H=24e3*(2.5/Math.max(.5,p)),$=a.length>0?a[a.length-1].t:0,L=Math.max(0,$-H),ae=Math.max(H,$+200),x=f=>s.left+(f-L)/(ae-L)*N,Z=a.filter(f=>f.t>=L-500),T=Z.length>1?`M ${Z.map(f=>`${x(f.t)},${d(f.y)}`).join(" L ")}`:"",k=[],Y=Math.ceil(L/500)*500,q=H>6e4?5e3:H>3e4?1e3:500;for(let f=Y;f<=ae;f+=q)k.push(f);const re=[0,1,2,3];return e.jsxs("svg",{viewBox:`0 0 ${c} ${n}`,className:"w-full h-full",preserveAspectRatio:"xMidYMid meet",children:[e.jsx("rect",{x:0,y:0,width:c,height:n,fill:E,rx:8}),e.jsx("pattern",{id:"scanlines",patternUnits:"userSpaceOnUse",width:"4",height:"4",children:e.jsx("line",{x1:"0",y1:"0",x2:"4",y2:"0",stroke:"#000",strokeOpacity:"0.2",strokeWidth:"1"})}),e.jsx("rect",{x:0,y:0,width:c,height:n,fill:"url(#scanlines)",pointerEvents:"none"}),re.map((f,y)=>e.jsx("line",{x1:s.left,y1:d(f),x2:c-s.right,y2:d(f),stroke:f===0?M:m,strokeWidth:1},`hgrid-${y}`)),k.map((f,y)=>e.jsx("line",{x1:x(f),y1:s.top,x2:x(f),y2:n-s.bottom,stroke:f%1e3===0?M:m,strokeWidth:1},`tmark-${y}`)),e.jsxs("defs",{children:[e.jsxs("filter",{id:"oscilloscopeGlow",x:"-50%",y:"-50%",width:"200%",height:"200%",children:[e.jsx("feGaussianBlur",{stdDeviation:"2",result:"blur"}),e.jsx("feComposite",{in:"SourceGraphic",in2:"blur",operator:"over"})]}),e.jsx("marker",{id:"arrowAmber",viewBox:"0 0 10 10",refX:"10",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto",children:e.jsx("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:"#f59e0b"})}),e.jsx("marker",{id:"arrowBlue",viewBox:"0 0 10 10",refX:"10",refY:"5",markerWidth:"6",markerHeight:"6",orient:"auto",children:e.jsx("path",{d:"M 0 0 L 10 5 L 0 10 z",fill:"#38bdf8"})})]}),e.jsx("path",{d:T,fill:"none",stroke:h,strokeWidth:2,filter:"url(#oscilloscopeGlow)"}),(()=>{const f=te(i,o),y=f.periodMs,X=y*2+y*.16,B=x(X),R=y*2+y*.7,g=x(R),j=y*3,A=y*7,V=x(j),z=x(A),ie=(V+z)/2;if(a.length===0||t&&o!=="summation")return null;if(o==="extra-systole")return e.jsxs(e.Fragment,{children:[e.jsxs("g",{children:[e.jsx("text",{x:B,y:d(-2)+110,textAnchor:"middle",fill:"#f59e0b",fontSize:24,fontFamily:"monospace",fontWeight:"bold",style:{filter:"drop-shadow(0 0 4px rgba(0,0,0,0.8))"},children:"Extra Systole"}),e.jsx("line",{x1:B,y1:d(-2)+85,x2:B,y2:d(-2)+12,stroke:"#f59e0b",strokeWidth:3}),e.jsx("path",{d:`M ${B-10} ${d(-2)+22} L ${B} ${d(-2)+8} L ${B+10} ${d(-2)+22}`,fill:"none",stroke:"#f59e0b",strokeWidth:3,strokeLinejoin:"round"})]}),e.jsxs("g",{children:[e.jsx("text",{x:g,y:d(3)-90,textAnchor:"middle",fill:"#38bdf8",fontSize:24,fontFamily:"monospace",fontWeight:"bold",style:{filter:"drop-shadow(0 0 4px rgba(0,0,0,0.8))"},children:"Compensatory Pause"}),e.jsx("line",{x1:g,y1:d(3)-65,x2:g,y2:d(3)-10,stroke:"#38bdf8",strokeWidth:3}),e.jsx("path",{d:`M ${g-10} ${d(3)-22} L ${g} ${d(3)-8} L ${g+10} ${d(3)-22}`,fill:"none",stroke:"#38bdf8",strokeWidth:3,strokeLinejoin:"round"})]}),e.jsxs("g",{children:[e.jsx("line",{x1:V,y1:n-s.bottom+15,x2:z,y2:n-s.bottom+15,stroke:"#c084fc",strokeWidth:3}),e.jsx("line",{x1:V,y1:n-s.bottom+5,x2:V,y2:n-s.bottom+25,stroke:"#c084fc",strokeWidth:3}),e.jsx("line",{x1:z,y1:n-s.bottom+5,x2:z,y2:n-s.bottom+25,stroke:"#c084fc",strokeWidth:3}),e.jsx("text",{x:ie,y:n-s.bottom+65,textAnchor:"middle",fill:"#c084fc",fontSize:26,fontFamily:"monospace",fontWeight:"bold",style:{filter:"drop-shadow(0 0 4px rgba(0,0,0,0.8))"},children:"Treppe (Staircase)"})]})]});if(o==="summation"){const G=te(i,o).periodMs,O=0,b=G*2,C=G*4,Q=x(O),w=n-s.bottom+40,U=[];U.push(0),U.push(b);for(let ee=0;ee<5;ee++)U.push(C-1250+ee*250);const fe=U.filter(ee=>!t||ee<=$),he=t?Math.min(c-s.right,x($)):c-s.right,xe=s.left;return e.jsxs(e.Fragment,{children:[he>xe&&e.jsx("line",{x1:xe,y1:w,x2:he,y2:w,stroke:"#ef4444",strokeWidth:2}),fe.map((ee,me)=>e.jsx("line",{x1:x(ee),y1:w-10,x2:x(ee),y2:w+10,stroke:"#ef4444",strokeWidth:2},me)),(!t||$>=O)&&e.jsxs("g",{children:[e.jsx("text",{x:Q,y:w+100,textAnchor:"start",fill:"#22c55e",fontSize:18,fontFamily:"monospace",fontWeight:"bold",children:"Threshold"}),e.jsx("line",{x1:Q+5,y1:w+75,x2:Q,y2:w+15,stroke:"#22c55e",strokeWidth:2,strokeDasharray:"4 2"}),e.jsx("path",{d:`M ${Q-4} ${w+20} L ${Q} ${w+12} L ${Q+4} ${w+20}`,fill:"none",stroke:"#22c55e",strokeWidth:2})]}),(!t||$>=b)&&e.jsxs("g",{children:[e.jsx("text",{x:x(b),y:w+100,textAnchor:"middle",fill:"#fbbf24",fontSize:18,fontFamily:"monospace",fontWeight:"bold",children:"Sub-threshold"}),e.jsx("line",{x1:x(b),y1:w+75,x2:x(b),y2:w+15,stroke:"#fbbf24",strokeWidth:2,strokeDasharray:"4 2"}),e.jsx("path",{d:`M ${x(b)-4} ${w+20} L ${x(b)} ${w+12} L ${x(b)+4} ${w+20}`,fill:"none",stroke:"#fbbf24",strokeWidth:2})]}),(!t||$>=C-1250)&&e.jsxs("g",{children:[e.jsx("line",{x1:x(C-1250),y1:w+15,x2:x(C-250),y2:w+15,stroke:"#ef4444",strokeWidth:2}),e.jsx("line",{x1:x(C-1250),y1:w+10,x2:x(C-1250),y2:w+20,stroke:"#ef4444",strokeWidth:2}),e.jsx("line",{x1:x(C-250),y1:w+10,x2:x(C-250),y2:w+20,stroke:"#ef4444",strokeWidth:2}),e.jsx("text",{x:x(C-1250),y:w+40,textAnchor:"start",fill:"#ef4444",fontSize:18,fontFamily:"monospace",fontWeight:"bold",children:"Summation (5 subthreshold)"})]})]})}if(o==="staircase"){const G=y*4,O=x(0),b=x(G),C=(O+b)/2;return e.jsxs("g",{children:[e.jsx("line",{x1:O,y1:n-s.bottom+15,x2:b,y2:n-s.bottom+15,stroke:"#c084fc",strokeWidth:3}),e.jsx("line",{x1:O,y1:n-s.bottom+5,x2:O,y2:n-s.bottom+25,stroke:"#c084fc",strokeWidth:3}),e.jsx("line",{x1:b,y1:n-s.bottom+5,x2:b,y2:n-s.bottom+25,stroke:"#c084fc",strokeWidth:3}),e.jsx("text",{x:C,y:n-s.bottom+65,textAnchor:"middle",fill:"#c084fc",fontSize:26,fontFamily:"monospace",fontWeight:"bold",style:{filter:"drop-shadow(0 0 4px rgba(0,0,0,0.8))"},children:"Treppe (Staircase)"})]})}if(o==="heart-block"){const b=x(9999.5),w=(23333+33333)/2,U=x(w);return e.jsxs(e.Fragment,{children:[e.jsxs("g",{children:[e.jsx("text",{x:b,y:d(3)-130,textAnchor:"middle",fill:"#f59e0b",fontSize:24,fontFamily:"monospace",fontWeight:"bold",style:{filter:"drop-shadow(0 0 4px rgba(0,0,0,0.8))"},children:"1st Stannius Ligature"}),e.jsx("line",{x1:b,y1:d(3)-105,x2:b,y2:d(3)-12,stroke:"#f59e0b",strokeWidth:3}),e.jsx("path",{d:`M ${b-10} ${d(3)-22} L ${b} ${d(3)-8} L ${b+10} ${d(3)-22}`,fill:"none",stroke:"#f59e0b",strokeWidth:3,strokeLinejoin:"round"})]}),e.jsxs("g",{children:[e.jsx("text",{x:U,y:d(3)-70,textAnchor:"middle",fill:"#38bdf8",fontSize:24,fontFamily:"monospace",fontWeight:"bold",style:{filter:"drop-shadow(0 0 4px rgba(0,0,0,0.8))"},children:"2nd Stannius Ligature"}),e.jsx("line",{x1:U,y1:d(3)-45,x2:U,y2:d(3)-12,stroke:"#38bdf8",strokeWidth:3}),e.jsx("path",{d:`M ${U-10} ${d(3)-22} L ${U} ${d(3)-8} L ${U+10} ${d(3)-22}`,fill:"none",stroke:"#38bdf8",strokeWidth:3,strokeLinejoin:"round"})]}),e.jsx("text",{x:x(3333),y:n-15,textAnchor:"middle",fill:"#a3e635",fontSize:18,fontFamily:"monospace",fontWeight:"bold",children:"36 BPM"}),e.jsx("text",{x:x(18333),y:n-15,textAnchor:"middle",fill:"#a3e635",fontSize:18,fontFamily:"monospace",fontWeight:"bold",children:"24 BPM"}),e.jsx("text",{x:x(45e3),y:n-15,textAnchor:"middle",fill:"#a3e635",fontSize:18,fontFamily:"monospace",fontWeight:"bold",children:"12 BPM"})]})}if(o==="all-or-none"){const oe=f.periodMs+4e3,G=["Sub threshold","Threshold","Maximal","Supramaximal"];return e.jsx(e.Fragment,{children:G.map((O,b)=>{const C=x(b*oe),Q=b%2===1,w=Q?35:75,U=Q?50:90;return e.jsxs("g",{children:[e.jsx("text",{x:C,y:w,textAnchor:b===0?"start":"middle",fill:"#facc15",fontSize:22,fontFamily:"monospace",fontWeight:"bold",style:{filter:"drop-shadow(0 0 4px rgba(0,0,0,0.8))"},children:O}),e.jsx("line",{x1:b===0?C+10:C,y1:U,x2:b===0?C+10:C,y2:d(3)-12,stroke:"#facc15",strokeWidth:3}),e.jsx("path",{d:`M ${(b===0?C+10:C)-7} ${d(3)-24} L ${b===0?C+10:C} ${d(3)-10} L ${(b===0?C+10:C)+7} ${d(3)-24}`,fill:"none",stroke:"#facc15",strokeWidth:3})]},`all-none-${b}`)})})}return null})(),e.jsxs("text",{x:c-s.right-10,y:s.top+20,textAnchor:"end",fill:h,fontSize:14,fontFamily:"monospace",fontWeight:"bold",children:["HR: ",v," BPM"]}),e.jsxs("text",{x:c-s.right-10,y:s.top+40,textAnchor:"end",fill:M,fontSize:12,fontFamily:"monospace",children:["T: ",i,"°C"]}),t&&e.jsx("text",{x:s.left+10,y:s.top+20,fill:"#ef4444",fontSize:14,fontFamily:"monospace",fontWeight:"bold",children:"● REC"})]})},Oe=({isPressed:a,onHoverChange:i})=>{const t=l.useRef(null);return le((o,p)=>{if(t.current){const v=a?.05:.2;t.current.rotation.z=$e.lerp(t.current.rotation.z,v,p*10)}}),e.jsx(W,{label:"Tap Key (Stimulus)",onHoverChange:i,children:e.jsxs("group",{position:[2.8,-.68,.8],rotation:[0,-.2,0],children:[e.jsx(P,{args:[1.4,.12,.7],position:[0,.06,0],children:e.jsx("meshStandardMaterial",{color:"#111",roughness:.2,metalness:.1})}),e.jsxs("group",{position:[-.5,.12,.15],children:[e.jsxs(S,{args:[.05,.05,.02],position:[0,0,0],children:[" ",e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8})," "]}),e.jsx(S,{args:[.05,.07,.25],position:[0,.12,0],children:e.jsx("meshStandardMaterial",{color:"#1a1a1a",roughness:.3})}),e.jsxs(S,{args:[.02,.02,.05],position:[0,.26,0],children:[" ",e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8})," "]})]}),e.jsxs("group",{position:[.5,.12,.15],children:[e.jsxs(S,{args:[.05,.05,.02],position:[0,0,0],children:[" ",e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8})," "]}),e.jsx(S,{args:[.05,.07,.25],position:[0,.12,0],children:e.jsx("meshStandardMaterial",{color:"#1a1a1a",roughness:.3})}),e.jsxs(S,{args:[.02,.02,.05],position:[0,.26,0],children:[" ",e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8})," "]})]}),e.jsxs("group",{position:[-.4,.12,-.1],children:[e.jsx(P,{args:[.2,.01,.3],position:[0,0,0],children:e.jsx("meshStandardMaterial",{color:"#c0c0c0",metalness:.8})}),e.jsx(S,{args:[.02,.02,.05],position:[0,.02,0],children:e.jsx("meshStandardMaterial",{color:"#c0c0c0",metalness:.8})}),e.jsxs("group",{ref:t,rotation:[0,0,.2],children:[e.jsx(P,{args:[1.1,.015,.12],position:[.55,0,0],children:e.jsx("meshStandardMaterial",{color:"#e2e8f0",metalness:.7,roughness:.3})}),e.jsxs("group",{position:[1,.01,0],children:[e.jsx(S,{args:[.015,.015,.15],position:[0,.08,0],children:e.jsx("meshStandardMaterial",{color:"#111"})}),e.jsx(S,{args:[.15,.15,.08],position:[0,.16,0],children:e.jsx("meshStandardMaterial",{color:"#111",roughness:.6})}),e.jsx(S,{args:[.02,.02,.06],position:[0,-.04,0],children:e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8})})]})]})]}),e.jsxs("group",{position:[.6,.12,-.1],children:[e.jsx(P,{args:[.15,.01,.15],position:[0,0,0],children:e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8})}),e.jsx(S,{args:[.03,.03,.06],position:[0,.03,0],children:e.jsx("meshStandardMaterial",{color:"#d4af37",metalness:.8})})]}),e.jsx(I,{args:[new _([new r(-.5,.12,.15),new r(-.6,.12,.3)]),8,.01,8,!1],children:e.jsx("meshStandardMaterial",{color:"#333"})}),e.jsx(I,{args:[new _([new r(.5,.12,.15),new r(.6,.12,.3)]),8,.01,8,!1],children:e.jsx("meshStandardMaterial",{color:"#333"})})]})})},Ke=({onBack:a})=>{const[i,t]=l.useState(25),[o,p]=l.useState("heart-block"),[v,h]=l.useState(null),[m,M]=l.useState(0),[E,c]=l.useState(2.5),[n,s]=l.useState("3d"),[N,F]=l.useState(!1),[u,D]=l.useState({time:0,isRecording:!1,data:[],currentContraction:3,heartRate:24,temperature:25}),d=l.useRef(),se=l.useRef(0),K=l.useRef([]),H=20,$=l.useRef(0),L=l.useRef(i);l.useEffect(()=>{L.current=i},[i]),l.useEffect(()=>{c(o==="heart-block"?1:o==="all-or-none"?1.5:2.5)},[o]);const ae=()=>{u.isRecording||(K.current=[],$.current=0,D({time:0,isRecording:!0,data:[],currentContraction:3,heartRate:te(i,o).hr,temperature:i}),M(T=>T+1),se.current=0)},x=()=>{D(T=>({...T,isRecording:!1})),d.current&&cancelAnimationFrame(d.current)},Z=()=>{K.current=[],$.current=0,D({time:0,isRecording:!1,data:[],currentContraction:3,heartRate:te(i,o).hr,temperature:i}),M(T=>T+1),d.current&&cancelAnimationFrame(d.current)};return l.useEffect(()=>{if(!u.isRecording){D(q=>({...q,heartRate:te(i,o).hr}));return}let T=Date.now(),k=0;se.current=Date.now();const Y=()=>{const q=Date.now(),re=q-T;T=q,k+=re;const f=te(L.current,o);let y=0,X=0,B=f.hr;if(o==="heart-block"){const j=1666.6666666666667,A=8,V=A*j,z=60/24*1e3,ie=8,oe=V+ie*z;if(k<V)y=Math.floor(k/j),X=k%j/j,B=36;else if(k<oe){const G=k-V;y=A+Math.floor(G/z),X=G%z/z,B=24}else{const O=k-oe;y=A+ie+Math.floor(O/5e3),X=O%5e3/5e3,B=12}if(y>=25){D(G=>({...G,isRecording:!1}));return}}else if(o==="all-or-none"){const j=f.periodMs,V=j+4e3;y=Math.floor(k/V);const z=k%V;if(z<j?X=z/j:X=-1,y>=4){D(ie=>({...ie,isRecording:!1}));return}}else{y=Math.floor(k/f.periodMs),X=k%f.periodMs/f.periodMs;let j=10;if(o==="summation"&&(j=5),y>=j){D(A=>({...A,isRecording:!1}));return}}const R=Fe(X,f.amplitude,y,o),g=Math.max(0,R);k-$.current>=H&&($.current=k,K.current.push({t:k,y:R})),D(j=>({...j,time:k,currentContraction:g,heartRate:B,data:K.current,ligature1:o==="heart-block"&&y>=4,ligature2:o==="heart-block"&&y>=12})),d.current=requestAnimationFrame(Y)};return d.current=requestAnimationFrame(Y),()=>{d.current&&cancelAnimationFrame(d.current)}},[u.isRecording]),e.jsxs("div",{className:"flex flex-col h-screen bg-slate-950 text-slate-100 font-sans",children:[e.jsx("header",{className:"flex items-center justify-between px-6 py-4 bg-slate-900 border-b border-slate-800",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:a,className:"p-2 hover:bg-slate-800 rounded-lg text-slate-400",children:e.jsx(ge,{className:"w-5 h-5"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-red-400 to-pink-500 bg-clip-text text-transparent",children:"Properties of Cardiac Muscle"}),e.jsx("p",{className:"text-slate-400 text-xs",children:"Amphibian / Frog Heart — Effect of Temperature"})]})]})}),e.jsxs("main",{className:"flex-1 flex flex-col lg:flex-row overflow-hidden",children:[e.jsxs("div",{className:"lg:hidden flex bg-slate-800 border-b border-slate-700",children:[e.jsxs("button",{onClick:()=>s("3d"),className:`flex-1 py-3 px-4 flex items-center justify-center gap-2 font-medium transition-all ${n==="3d"?"bg-slate-900 text-red-400 border-b-2 border-red-400":"text-slate-400 hover:text-slate-200"}`,children:[e.jsx(pe,{className:"w-4 h-4"}),e.jsx("span",{children:"3D View"})]}),e.jsxs("button",{onClick:()=>s("graph"),className:`flex-1 py-3 px-4 flex items-center justify-center gap-2 font-medium transition-all ${n==="graph"?"bg-slate-900 text-red-400 border-b-2 border-red-400":"text-slate-400 hover:text-slate-200"}`,children:[e.jsx(je,{className:"w-4 h-4"}),e.jsx("span",{children:"Cardiogram"})]})]}),e.jsxs("div",{className:`flex-1 relative bg-black ${n==="graph"?"hidden lg:flex":"flex"}`,children:[e.jsxs(be,{shadows:!0,camera:{position:[2,2,7],fov:38},children:[e.jsx("color",{attach:"background",args:["#0f172a"]}),e.jsx(Se,{preset:"city"}),e.jsx("ambientLight",{intensity:.6,color:"#ffffff"}),e.jsx("spotLight",{position:[10,10,5],angle:.3,penumbra:.5,intensity:2,castShadow:!0}),e.jsx("pointLight",{position:[-5,5,-3],intensity:.5,color:"#ffeedd"}),e.jsx("group",{position:[0,-1.2,0],children:e.jsxs("group",{position:[-.5,0,0],children:[e.jsxs("group",{rotation:[0,-Math.PI*.5,0],position:[-.01,-.84,.25],children:[e.jsx(De,{onHoverChange:h}),e.jsx("group",{position:[-.2,0,0],rotation:[0,-Math.PI/2,0],children:e.jsx(Ve,{onHoverChange:h})}),e.jsx("group",{position:[.3,.48,0],rotation:[0,-Math.PI/2,0],children:e.jsx(Be,{contraction:u.currentContraction,temperature:i,onHoverChange:h,showLigature1:!!u.ligature1,isTight1:u.ligature1,showLigature2:!!u.ligature2,isTight2:u.ligature2})})]}),e.jsx(Ie,{contraction:u.currentContraction}),e.jsx(_e,{angle:(3-u.currentContraction)*.036,onHoverChange:h}),o==="summation"&&e.jsx(Oe,{isPressed:u.isRecording&&(()=>{const k=te(i,o).periodMs,Y=k*2,q=k*4,re=u.time<150,f=u.time>Y&&u.time<Y+150,y=q-1300,X=q,B=u.time>y&&u.time<X&&u.time%250<100;return re||f||B})(),onHoverChange:h}),e.jsx("group",{position:[4.395,.75,.05],children:e.jsx(Xe,{simTime:u.time,waveformValue:u.currentContraction,isRecording:u.isRecording,onHoverChange:h,resetKey:m,drumSpeed:E})})]})}),e.jsx(Me,{makeDefault:!0,minPolarAngle:0})]}),v&&e.jsx("div",{className:"absolute top-4 left-4 bg-slate-900/90 text-white px-3 py-1.5 rounded-full text-sm border border-slate-700 backdrop-blur-sm pointer-events-none animate-in fade-in duration-200",children:v})]}),e.jsxs("div",{className:"w-full lg:w-[450px] bg-slate-900 border-l border-slate-800 flex flex-col flex-1 lg:flex-none",children:[e.jsxs("div",{className:`flex-1 p-4 min-h-0 flex flex-col border-b border-slate-800 ${n==="3d"?"hidden lg:flex":"flex"}`,children:[e.jsx("h3",{className:"text-slate-400 text-sm font-bold uppercase tracking-wider mb-2",children:"Oscilloscope View"}),e.jsx("div",{className:"flex-1 bg-slate-950 rounded-lg border border-slate-800 overflow-hidden relative",children:e.jsx(Ge,{data:u.data,temperature:i,isRecording:u.isRecording,selectedExperiment:o,drumSpeed:E,heartRate:u.heartRate})})]}),e.jsxs("div",{className:"p-4 lg:p-6 bg-slate-900 z-10 space-y-4 overflow-y-auto",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-xs font-bold text-slate-400 uppercase flex items-center gap-2 mb-2",children:[e.jsx(ye,{className:"w-4 h-4 text-emerald-400"})," Select Experiment"]}),e.jsxs("select",{value:o,onChange:T=>{const k=T.target.value;p(k),K.current=[],$.current=0,D({time:0,isRecording:!1,data:[],currentContraction:3,heartRate:te(i,k).hr,temperature:i}),M(Y=>Y+1),d.current&&cancelAnimationFrame(d.current)},className:"w-full bg-slate-800 border border-slate-700 text-slate-200 text-sm rounded-lg focus:ring-emerald-500 focus:border-emerald-500 block p-2.5 outline-none",children:[e.jsx("option",{value:"extra-systole",children:"1. Extra systole and compensatory pause"}),e.jsx("option",{value:"heart-block",children:"2. Heart block: Stannius ligatures"}),e.jsx("option",{value:"all-or-none",children:"3. All or none law"}),e.jsx("option",{value:"staircase",children:"4. Stair case phenomenon"}),e.jsx("option",{value:"summation",children:"5. Summation of subliminal stimuli"})]})]}),e.jsxs("div",{className:"bg-slate-800 p-3 rounded-lg border border-slate-700",children:[e.jsxs("div",{className:"flex justify-between mb-1.5",children:[e.jsxs("label",{className:"text-xs font-bold text-slate-400 uppercase flex items-center gap-1.5",children:[e.jsx(Ae,{className:"w-3.5 h-3.5 text-cyan-400"})," Drum Speed"]}),e.jsxs("span",{className:"text-cyan-400 font-mono text-sm",children:[E," mm/s"]})]}),e.jsx("input",{type:"range",min:"1",max:"10",step:"0.5",value:E,onChange:T=>c(Number(T.target.value)),disabled:o==="heart-block"||o==="all-or-none",className:`w-full h-2 rounded-lg appearance-none cursor-pointer accent-cyan-500 ${o==="heart-block"||o==="all-or-none"?"opacity-50 cursor-not-allowed bg-slate-700":"bg-slate-600"}`}),e.jsxs("div",{className:"flex justify-between text-[10px] text-slate-500 mt-1",children:[e.jsx("span",{children:"1 mm/s"}),e.jsx("span",{children:"10 mm/s"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[u.isRecording?e.jsxs("button",{onClick:x,className:"flex-1 bg-slate-700 hover:bg-slate-600 text-white font-bold py-3 rounded-xl transition-all flex items-center justify-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5"})," Stop"]}):e.jsxs("button",{onClick:ae,className:"flex-1 bg-red-600 hover:bg-red-500 text-white font-bold py-3 rounded-xl shadow-lg transition-all flex items-center justify-center gap-2",children:[e.jsx(Te,{className:"w-5 h-5"})," Start Recording"]}),e.jsxs("button",{onClick:Z,className:"px-6 bg-slate-800 hover:bg-slate-700 text-slate-300 font-bold py-3 rounded-xl transition-all border border-slate-700 flex items-center justify-center gap-2",children:[e.jsx(we,{className:"w-4 h-4"})," Reset"]})]})]})]})]})]})};export{Ke as PropertiesOfCardiacMuscle};
