import{c as V,r as l,j as e,A as J,a as Q,E as Z,O as ee,x as te,y as se,w as ae,u as W}from"./index-CS9C6yt0.js";import{B as g,C as w,S as re}from"./shapes-uqME3MbK.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=V("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),_=10,E=40,X=50,P=200,oe=110,T=({label:o,children:a,onHoverChange:d})=>e.jsx("group",{onPointerOver:r=>{d&&(r.stopPropagation(),d(o),document.body.style.cursor="pointer")},onPointerOut:r=>{d&&(d(null),document.body.style.cursor="auto")},children:a}),z=(o,a)=>a==="After-Loaded"?0:o/oe*1.5,U=(o,a)=>a==="After-Loaded"?5*Math.max(0,1-o/120):(5.5+o/100*1.5*2)*Math.max(0,1-o/140),ie=(o,a,d)=>{const r=-d;if(o<0||o<_)return r;const p=o-_;let x=0;if(p<E){const h=p/E;x=a*Math.sin(h*(Math.PI/2))}else if(p<E+X){const u=(p-E)/X;x=a*((1+Math.cos(u*Math.PI))/2)}return r+x},le=({muscleShortening:o,onHoverChange:a})=>e.jsx(T,{label:"Lucas Chamber & Muscle",onHoverChange:a,children:e.jsxs("group",{position:[-2,0,0],children:[e.jsxs("group",{position:[0,-.5,0],children:[e.jsx(g,{args:[3.2,.2,1.5],position:[0,-.1,0],children:e.jsx("meshPhysicalMaterial",{color:"#cbd5e1",roughness:.1,transmission:.2,thickness:.5})}),e.jsx(g,{args:[3.2,1,.1],position:[0,.5,.7],children:e.jsx("meshPhysicalMaterial",{color:"#ffffff",transmission:.95,opacity:1,roughness:0,thickness:.1,clearcoat:1})}),e.jsx(g,{args:[3.2,1,.1],position:[0,.5,-.7],children:e.jsx("meshPhysicalMaterial",{color:"#ffffff",transmission:.95,opacity:1,roughness:0,thickness:.1,clearcoat:1})}),e.jsx(g,{args:[.1,1,1.3],position:[1.55,.5,0],children:e.jsx("meshPhysicalMaterial",{color:"#ffffff",transmission:.95,opacity:1,roughness:0,thickness:.1,clearcoat:1})}),e.jsx(g,{args:[.1,1,1.3],position:[-1.55,.5,0],children:e.jsx("meshPhysicalMaterial",{color:"#ffffff",transmission:.95,opacity:1,roughness:0,thickness:.1,clearcoat:1})}),e.jsx(g,{args:[3,.8,1.3],position:[0,.4,0],children:e.jsx("meshPhysicalMaterial",{color:"#a5f3fc",transmission:.9,opacity:.6,transparent:!0,roughness:.1,ior:1.33})})]}),e.jsxs("group",{position:[0,.2,0],children:[e.jsx(w,{args:[.05,.05,.8],rotation:[0,0,1.57],position:[-1.2,0,0],children:e.jsx("meshStandardMaterial",{color:"#94a3b8"})}),e.jsx("group",{position:[-1.2,0,0],children:e.jsxs("group",{scale:[1-o*.15,1+o*.3,1+o*.3],position:[1,0,0],children:[e.jsx(re,{args:[.3,16,16],scale:[3,1,1],position:[0,0,0],children:e.jsx("meshStandardMaterial",{color:"#be123c",roughness:.6})}),e.jsx(g,{args:[1.2,.05,.05],position:[1.4,0,0],children:e.jsx("meshStandardMaterial",{color:"#f1f5f9"})})]})})]})]})}),ce=({angle:o,load:a,onHoverChange:d})=>{const r="#b8860b";return e.jsxs("group",{position:[0,1.5,0],children:[e.jsx(T,{label:"Stand",onHoverChange:d,children:e.jsxs("group",{position:[0,-1.5,0],children:[e.jsx(g,{args:[.6,.1,.4],position:[0,-.05,0],children:e.jsx("meshStandardMaterial",{color:"#8b6914"})}),e.jsx(w,{args:[.08,.1,2.8],position:[0,1.35,0],children:e.jsx("meshStandardMaterial",{color:"#c0c0c0"})})]})}),e.jsxs("group",{position:[-.4,-.8,0],rotation:[0,0,-Math.PI/2-o],children:[e.jsxs(T,{label:"Lever Support",onHoverChange:d,children:[e.jsx(g,{args:[.12,.6,.08],position:[0,-.1,-1.11],children:e.jsx("meshStandardMaterial",{color:r})}),e.jsx("group",{position:[0,0,.25],rotation:[0,0,.7],children:e.jsx(g,{args:[.12,.6,.08],position:[0,-.1,-.14],children:e.jsx("meshStandardMaterial",{color:r})})}),e.jsx(g,{args:[.12,.1,1.3],position:[0,.15,-.5],children:e.jsx("meshStandardMaterial",{color:r})})]}),e.jsx(T,{label:"Writing Lever",onHoverChange:d,children:e.jsxs("group",{rotation:[0,Math.PI,-Math.PI/2],children:[e.jsx(g,{args:[4.5,.08,.05],position:[2.2,0,1.1],children:e.jsx("meshStandardMaterial",{color:r})}),a>0&&e.jsxs("group",{position:[1.5,-.1,1.1],rotation:[0,0,Math.PI/2],children:[e.jsx(w,{args:[.01,.01,.4],position:[0,-.2,0],children:e.jsx("meshStandardMaterial",{color:"#000"})}),e.jsx("group",{position:[0,-.4,0],children:Array.from({length:Math.ceil(a/10)}).map((h,u)=>e.jsx(w,{args:[.15,.15,.05,16],position:[0,-u*.06,0],children:e.jsx("meshStandardMaterial",{color:"#475569",metalness:.8})},u))})]}),e.jsx("group",{position:[3.45,0,-.5],children:e.jsx(w,{args:[.012,.005,.6],rotation:[0,0,-Math.PI/2],position:[.3,0,0],children:e.jsx("meshStandardMaterial",{color:"#1a1a1a"})})})]})})]})]})},de=({simTime:o,tension:a,isRunning:d,onHoverChange:r,resetKey:p,drumMode:x,drumOffset:h,historyLength:u})=>{const S=l.useRef(document.createElement("canvas")),y=l.useRef(null),b=l.useMemo(()=>{const s=S.current;s.width=1024,s.height=512;const f=s.getContext("2d");return f&&(f.fillStyle="#000",f.fillRect(0,0,1024,512)),new ae(s)},[]);l.useEffect(()=>{const s=S.current.getContext("2d");s&&(s.fillStyle="#000",s.fillRect(0,0,1024,512),b.needsUpdate=!0),y.current=null},[p,b]);const R=l.useRef(h);l.useEffect(()=>{if(R.current!==h){if(u>1){const s=S.current.getContext("2d");if(s){const f=50+R.current*30,A=50+h*30,M=512*.5-a*80,L=5;s.strokeStyle="#fff",s.lineWidth=3,s.beginPath(),s.moveTo(f,M),s.lineTo(A-L,M),s.stroke(),b.needsUpdate=!0}}R.current=h}},[h,a,b,u]),W(()=>{if(!d){y.current=null;return}const s=S.current.getContext("2d");if(!s)return;const A=1024*(Math.PI/4/(2*Math.PI));let M=50;x==="Moving"?M=50+o/P*A:M=50+h*30;const L=512*.5-a*80;y.current&&(s.strokeStyle="#fff",s.lineWidth=3,s.beginPath(),s.moveTo(y.current.x,y.current.y),s.lineTo(M,L),s.stroke(),b.needsUpdate=!0),y.current={x:M,y:L}});const N=l.useRef(null);return W(()=>{if(N.current){let s=1.5;const f=h*30/1024*(2*Math.PI);if(x==="Moving"&&d){const A=o/P*(Math.PI/4);N.current.rotation.y=s-f-A}else N.current.rotation.y=s-f}}),e.jsx(T,{label:"Kymograph",onHoverChange:r,children:e.jsxs("group",{position:[-2.5,1.5,2],children:[e.jsx("group",{ref:N,rotation:[0,1.5,0],children:e.jsxs(w,{args:[1.2,1.2,3,64],children:[e.jsx("meshBasicMaterial",{attach:"material-0",map:b}),e.jsx("meshStandardMaterial",{attach:"material-1",color:"#111"}),e.jsx("meshStandardMaterial",{attach:"material-2",color:"#111"})]})}),e.jsx(w,{args:[.1,.1,4.5],position:[0,-.25,0],children:e.jsx("meshStandardMaterial",{color:"#1e293b"})}),e.jsx(g,{args:[1.5,.5,2],position:[0,-2.25,0],children:e.jsx("meshStandardMaterial",{color:"#0f172a"})})]})})},xe=({visible:o,onHoverChange:a})=>e.jsx("group",{position:[-.4,.45,0],rotation:[0,0,Math.PI/6],children:e.jsx(T,{label:"After-Loading Screw",onHoverChange:a,children:e.jsxs("group",{visible:o,children:[e.jsx(w,{args:[.04,.04,.5],position:[0,-.25,0],children:e.jsx("meshStandardMaterial",{color:"#b8860b"})}),e.jsx(w,{args:[.08,.08,.05],position:[0,0,0],children:e.jsx("meshStandardMaterial",{color:"#b8860b"})})]})})}),me=({onBack:o})=>{const[a,d]=l.useState(10),[r,p]=l.useState("After-Loaded"),[x,h]=l.useState("Moving"),[u,S]=l.useState("Automatic"),[y,b]=l.useState(0),[R,N]=l.useState(null),[s,f]=l.useState([]),[A,M]=l.useState(0),[L,K]=l.useState(0),[c,O]=l.useState({time:0,isRunning:!1,data:[],currentHeight:0,phase:"Rest"}),C=l.useRef(),Y=()=>{if(c.isRunning)return;const n=z(a,r),t=U(a,r),i=a*t;O({time:0,isRunning:!0,data:[],currentHeight:-n,phase:"Latent"}),f(m=>[...m,{load:a,mode:r,maxHeight:t,work:i,id:Date.now(),baseLine:-n}]),M(m=>m+1)},q=()=>{f([]),K(n=>n+1),O({time:0,isRunning:!1,data:[],currentHeight:0,phase:"Rest"}),b(0)};l.useEffect(()=>{if(!c.isRunning){C.current&&cancelAnimationFrame(C.current);return}let n=Date.now(),t=c.time;const i=z(a,r),m=U(a,r),j=()=>{const v=Date.now(),D=v-n;if(n=v,t+=D*.2,t>P){const H=-i;O($=>({...$,isRunning:!1,time:P,currentHeight:H,phase:"Rest"}));return}const I=ie(t,m,i);let k="Rest";t<_?k="Latent":t<_+E?k="Contraction":k="Relaxation",O(H=>({...H,time:t,currentHeight:I,phase:k,data:[...H.data,{t,y:I}]})),C.current=requestAnimationFrame(j)};return C.current=requestAnimationFrame(j),()=>{C.current&&cancelAnimationFrame(C.current)}},[c.isRunning,a,r]),l.useEffect(()=>{!c.isRunning&&c.time>=P&&x==="Stationary"&&u==="Automatic"&&b(n=>n+1)},[c.isRunning,c.time,x,u]);const B=l.useRef(null);l.useEffect(()=>{const n=B.current;if(!n)return;const t=n.getContext("2d");if(!t)return;const i=n.width,m=n.height;if(s.length===0){t.fillStyle="#000",t.fillRect(0,0,i,m),t.strokeStyle="#333",t.lineWidth=1,t.beginPath();for(let v=0;v<i;v+=i/10)t.moveTo(v,0),t.lineTo(v,m);t.stroke(),t.strokeStyle="#64748b",t.lineWidth=1,t.beginPath();const j=m-0/8*m-50;t.moveTo(0,j),t.lineTo(i,j),t.stroke()}if(c.data.length>1){const j=c.data[c.data.length-1],v=c.data[c.data.length-2],D=k=>k/P*i,I=k=>m-50-k*30;t.beginPath(),t.strokeStyle=r==="After-Loaded"?"#4ade80":"#f472b6",t.lineWidth=3,t.moveTo(D(v.t),I(v.y)),t.lineTo(D(j.t),I(j.y)),t.stroke()}},[c.data,L]);const G=()=>{const t=i=>i/8*200;return e.jsxs("div",{className:"flex items-end h-full gap-4 overflow-x-auto pb-8 px-4 relative bg-black w-full min-w-full",children:[e.jsx("div",{className:"absolute left-0 right-0 bottom-12 h-px bg-slate-600 border-t border-dashed border-slate-500 z-0"}),s.map((i,m)=>{const j=t(i.maxHeight);return e.jsxs("div",{className:"flex flex-col items-center group relative z-10 shrink-0",children:[e.jsx("div",{className:`w-1 rounded-t ${i.mode==="After-Loaded"?"bg-green-500":"bg-pink-500"}`,style:{height:`${j}px`}}),e.jsxs("span",{className:"text-[10px] text-slate-500 mt-2 font-mono block",children:[i.load,"g"]}),e.jsxs("div",{className:"absolute bottom-full mb-2 hidden group-hover:block bg-slate-800 text-xs p-2 rounded z-20 whitespace-nowrap border border-slate-600 w-32 left-1/2 -translate-x-1/2 text-center pointer-events-none",children:[e.jsx("strong",{children:i.mode}),e.jsx("br",{}),"Load: ",i.load,"g",e.jsx("br",{}),"Height: ",i.maxHeight.toFixed(2),"cm",e.jsx("br",{}),"Ext: ",Math.abs(i.baseLine||0).toFixed(2),"cm"]})]},m)})]})},F=l.useMemo(()=>{const n=s.filter(t=>t.mode==="After-Loaded");return n.length===0?0:n.reduce((t,i)=>i.work>t.work?i:t,n[0]).load},[s]);return e.jsxs("div",{className:"flex flex-col h-screen bg-slate-950 text-slate-100 font-sans",children:[e.jsxs("header",{className:"flex items-center justify-between px-6 py-4 bg-slate-900 border-b border-slate-800",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:o,className:"p-2 hover:bg-slate-800 rounded-lg text-slate-400",children:e.jsx(J,{className:"w-5 h-5"})}),e.jsx("div",{children:e.jsx("h1",{className:"text-xl font-bold bg-gradient-to-r from-green-400 to-emerald-500 bg-clip-text text-transparent",children:"Effect of Load"})})]}),e.jsxs("div",{className:"flex gap-4 text-right",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400",children:"Current Load"}),e.jsxs("div",{className:"text-xl font-mono font-bold",children:[a,"g"]})]}),e.jsx("div",{className:"h-8 w-px bg-slate-700"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs text-slate-400",children:"Mode"}),e.jsx("div",{className:`text-sm font-bold ${r==="After-Loaded"?"text-green-400":"text-pink-400"}`,children:r})]})]})]}),e.jsxs("main",{className:"flex-1 flex flex-col lg:flex-row overflow-hidden",children:[e.jsxs("div",{className:"flex-1 relative bg-black",children:[e.jsxs(Q,{shadows:!0,camera:{position:[1,2,8],fov:35},children:[e.jsx("color",{attach:"background",args:["#0f172a"]}),e.jsx(Z,{preset:"city"}),e.jsx("ambientLight",{intensity:.6,color:"#ffffff"}),e.jsx("spotLight",{position:[10,10,5],angle:.3,penumbra:.5,intensity:2,castShadow:!0}),e.jsx("pointLight",{position:[-5,5,-5],intensity:1,color:"#38bdf8"}),e.jsxs("group",{position:[0,-1,0],children:[e.jsxs("group",{rotation:[0,Math.PI/2,0],children:[e.jsx(le,{muscleShortening:c.currentHeight,onHoverChange:N}),e.jsx(ce,{angle:c.currentHeight*.15,load:a,onHoverChange:N}),e.jsx(xe,{visible:r==="After-Loaded",onHoverChange:N})]}),e.jsx(de,{simTime:c.time,tension:c.currentHeight,isRunning:c.isRunning,onHoverChange:N,resetKey:L,drumMode:x,drumOffset:y,historyLength:s.length})]}),e.jsx(ee,{target:[1.5,0,0],minDistance:4,maxDistance:15,maxPolarAngle:Math.PI/2.1})]}),R&&e.jsx("div",{className:"absolute top-4 left-1/2 -translate-x-1/2 bg-black/70 backdrop-blur px-4 py-2 rounded-full border border-white/10 text-white font-bold text-sm pointer-events-none",children:R})]}),e.jsxs("div",{className:"w-full lg:w-[450px] bg-slate-900 border-l border-slate-800 flex flex-col h-full shrink-0",children:[e.jsxs("div",{className:"flex-1 p-4 bg-black relative border-b border-slate-800 min-h-[250px]",children:[x==="Moving"?e.jsx("canvas",{ref:B,width:420,height:250,className:"w-full h-full rounded border border-slate-800"}):G(),e.jsxs("div",{className:"absolute top-2 right-2 flex flex-col items-end gap-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:q,className:"text-[10px] px-2 py-1 rounded border bg-red-900/50 border-red-700 text-red-200 hover:bg-red-800",children:"Clear"}),e.jsx("button",{onClick:()=>h("Moving"),className:`text-[10px] px-2 py-1 rounded border ${x==="Moving"?"bg-blue-600 border-blue-500":"bg-slate-800 border-slate-700"}`,children:"Trace"}),e.jsx("button",{onClick:()=>h("Stationary"),className:`text-[10px] px-2 py-1 rounded border ${x==="Stationary"?"bg-blue-600 border-blue-500":"bg-slate-800 border-slate-700"}`,children:"Bar"})]}),x==="Stationary"&&e.jsxs("div",{className:"flex items-center gap-2 bg-slate-900/90 p-1.5 rounded border border-slate-700 animate-in fade-in slide-in-from-top-1",children:[e.jsxs("div",{className:"flex bg-slate-800 rounded p-0.5",children:[e.jsx("button",{onClick:()=>S("Automatic"),className:`px-2 py-0.5 text-[10px] rounded ${u==="Automatic"?"bg-blue-500 text-white":"text-slate-400 hover:text-slate-200"}`,children:"Auto"}),e.jsx("button",{onClick:()=>S("Manual"),className:`px-2 py-0.5 text-[10px] rounded ${u==="Manual"?"bg-blue-500 text-white":"text-slate-400 hover:text-slate-200"}`,children:"Manual"})]}),u==="Manual"&&e.jsxs("div",{className:"flex items-center gap-1 border-l border-slate-700 pl-2",children:[e.jsx("button",{onClick:()=>b(n=>Math.max(0,n-1)),className:"w-4 h-4 flex items-center justify-center rounded bg-slate-700 hover:bg-slate-600 text-[10px]",children:"<"}),e.jsx("span",{className:"text-[10px] font-mono w-4 text-center",children:y}),e.jsx("button",{onClick:()=>b(n=>n+1),className:"w-4 h-4 flex items-center justify-center rounded bg-slate-700 hover:bg-slate-600 text-[10px]",children:">"})]})]})]})]}),e.jsxs("div",{className:"p-6 space-y-6 overflow-y-auto",children:[e.jsxs("div",{className:"flex gap-2 p-1 bg-slate-800 rounded-lg",children:[e.jsx("button",{onClick:()=>p("After-Loaded"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${r==="After-Loaded"?"bg-green-600 text-white shadow":"text-slate-400 hover:text-white"}`,children:"After-Loaded"}),e.jsx("button",{onClick:()=>p("Free-Loaded"),className:`flex-1 py-2 text-sm font-bold rounded-md transition-all ${r==="Free-Loaded"?"bg-pink-600 text-white shadow":"text-slate-400 hover:text-white"}`,children:"Free-Loaded"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("label",{className:"text-sm font-medium text-slate-300 flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"})," Load (grams)"]}),e.jsx("span",{className:"text-xs text-slate-500",children:"Max: 100g"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("button",{onClick:()=>d(n=>Math.max(0,n-10)),className:"w-10 h-10 rounded-lg bg-slate-800 border border-slate-700 hover:bg-slate-700 disabled:opacity-50",disabled:a<=0,children:"-"}),e.jsx("div",{className:"flex-1 h-2 bg-slate-800 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-500 transition-all",style:{width:`${a/110*100}%`}})}),e.jsx("button",{onClick:()=>d(n=>Math.min(100,n+10)),className:"w-10 h-10 rounded-lg bg-slate-800 border border-slate-700 hover:bg-slate-700 disabled:opacity-50",disabled:a>=100,children:"+"})]})]}),e.jsx("button",{onClick:Y,disabled:c.isRunning,className:"w-full py-4 bg-indigo-600 hover:bg-indigo-500 disabled:bg-slate-700 text-white font-bold rounded-xl shadow-lg flex items-center justify-center gap-2 transition-all",children:c.isRunning?"In Progress...":e.jsxs(e.Fragment,{children:[e.jsx(se,{className:"w-5 h-5"})," Stimulate"]})}),e.jsxs("div",{className:"bg-slate-800/50 rounded-xl p-4 border border-slate-700 space-y-2",children:[e.jsx("h3",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:"Experiment Data"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{className:"bg-slate-800 p-2 rounded",children:[e.jsx("span",{className:"block text-slate-500",children:"Last Work Done"}),e.jsxs("span",{className:"block text-lg font-mono text-white",children:[s.length>0?s[s.length-1].work.toFixed(1):"-"," ",e.jsx("span",{className:"text-[10px] text-slate-500",children:"g-cm"})]})]}),e.jsxs("div",{className:"bg-slate-800 p-2 rounded relative",children:[e.jsx("span",{className:"block text-slate-500",children:"Optimal Load"}),e.jsx("span",{className:"block text-lg font-mono text-green-400",children:F>0?`${F}g`:"-"}),a===F&&a>0&&e.jsx(ne,{className:"absolute top-2 right-2 w-4 h-4 text-green-500"})]})]})]})]})]})]})]})};export{me as EffectOfLoad};
