import{c as G,r as P,R as L,j as e,A as E,b as R,E as z,O as B,M as A,B as u,u as $,C as X,d as Y}from"./index-D8q0WM6x.js";import{T as C}from"./Text-CV3BP445.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=G("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=G("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=G("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),O=.5,F={4:63,10:56,40:46,100:40},I=({radius:c,height:s,rotation:t,position:i})=>e.jsxs("group",{position:i,rotation:[t,0,0],children:[e.jsx(X,{args:[c,c,s,16],rotation:[0,0,Math.PI/2],children:e.jsx("meshStandardMaterial",{color:"#1a1a1a",roughness:.3})}),Array.from({length:12}).map((o,l)=>e.jsx(u,{args:[s+.02,.05,.05],position:[0,Math.cos(l/12*Math.PI*2)*c,Math.sin(l/12*Math.PI*2)*c],rotation:[-(l/12)*Math.PI*2,0,0],children:e.jsx("meshStandardMaterial",{color:"#222"})},l))]}),K=({onHover:c})=>e.jsxs("group",{position:[0,0,0],onPointerOver:s=>{s.stopPropagation(),c("Base / Horseshoe Foot")},onPointerOut:()=>c(null),children:[e.jsx(u,{args:[.8,.4,4],position:[-1.2,.2,.5],children:e.jsx("meshStandardMaterial",{color:"#111",roughness:.6})}),e.jsx(u,{args:[.8,.4,4],position:[1.2,.2,.5],children:e.jsx("meshStandardMaterial",{color:"#111",roughness:.6})}),e.jsx(u,{args:[3.2,.4,1],position:[0,.2,-1],children:e.jsx("meshStandardMaterial",{color:"#111",roughness:.6})}),e.jsxs("mesh",{position:[0,.8,-1],children:[e.jsx("cylinderGeometry",{args:[.4,.5,1.2]}),e.jsx("meshStandardMaterial",{color:"#111"})]})]}),D=({intensity:c,onHover:s})=>{const t=c/150*(Math.PI*2),i=t%(Math.PI*2),x=Math.abs(i-3*Math.PI/4),o=Math.abs(i-7*Math.PI/4);return e.jsx("group",{position:[0,.8,O],children:e.jsxs("group",{rotation:[t,0,0],children:[e.jsxs("mesh",{rotation:[0,0,0],onPointerOver:l=>{l.stopPropagation(),s("Mirror Frame")},onPointerOut:()=>s(null),children:[e.jsx("torusGeometry",{args:[.6,.08,16,32]}),e.jsx("meshStandardMaterial",{color:"#666",metalness:.8})]}),e.jsxs("mesh",{rotation:[Math.PI/2,0,0],children:[e.jsx("cylinderGeometry",{args:[.55,.55,.16,32]}),e.jsx("meshStandardMaterial",{color:"#222"})]}),e.jsxs("mesh",{position:[0,0,.081],onPointerOver:l=>{l.stopPropagation(),s("Plane Mirror")},onPointerOut:()=>s(null),children:[e.jsx("circleGeometry",{args:[.52,32]}),e.jsx("meshPhysicalMaterial",{color:"#ffffff",metalness:1,roughness:0,emissive:"#ffffff",emissiveIntensity:Math.max(0,1-o/.5)*(c/100)})]}),e.jsxs("mesh",{position:[0,0,-2.08],rotation:[Math.PI/2,0,0],onPointerOver:l=>{l.stopPropagation(),s("Concave Mirror")},onPointerOut:()=>s(null),children:[e.jsx("sphereGeometry",{args:[2,32,32,0,Math.PI*2,0,.265]}),e.jsx("meshPhysicalMaterial",{color:"#ffffff",metalness:1,roughness:0,emissive:"#ffffff",emissiveIntensity:Math.max(0,1-x/.5)*(c/100),side:2})]})]})})},U=({height:c,iris:s,intensity:t,onHover:i})=>{const x=1.5+c/100*.8;return e.jsxs("group",{position:[0,x,O],children:[e.jsxs("mesh",{onPointerOver:o=>{o.stopPropagation(),i("Condenser")},onPointerOut:()=>i(null),children:[e.jsx("cylinderGeometry",{args:[.5,.6,.6,32]}),e.jsx("meshStandardMaterial",{color:"#1a1a1a",metalness:.5})]}),e.jsxs("group",{position:[0,.35,0],onPointerOver:o=>{o.stopPropagation(),i("Iris Diaphragm")},onPointerOut:()=>i(null),children:[e.jsxs("mesh",{rotation:[Math.PI/2,0,0],children:[e.jsx("ringGeometry",{args:[s*.4,.5,32]}),e.jsx("meshStandardMaterial",{color:"#111",side:2})]}),e.jsxs("mesh",{position:[0,.01,0],rotation:[Math.PI/2,0,0],children:[e.jsx("circleGeometry",{args:[s*.4,32]}),e.jsx("meshBasicMaterial",{color:"#ffffcc",opacity:.3*(t/100),transparent:!0})]})]}),e.jsxs("mesh",{position:[.6,.35,0],rotation:[0,0,Math.PI/2-s*.5],children:[e.jsx("boxGeometry",{args:[.3,.05,.05]}),e.jsx("meshStandardMaterial",{color:"#444",metalness:.8})]}),e.jsxs("group",{position:[-.5,0,0],children:[e.jsxs("mesh",{position:[-.1,0,0],children:[e.jsx("boxGeometry",{args:[.2,.1,.1]}),e.jsx("meshStandardMaterial",{color:"#333"})]}),e.jsx("group",{onPointerOver:o=>{o.stopPropagation(),i("Condenser Adjustment Knob")},onPointerOut:()=>i(null),children:e.jsx(I,{radius:.3,height:.2,rotation:c*.1,position:[-.2,0,0]})})]})]})},q=({intensity:c,mirrorTilt:s,condenserY:t,iris:i,side:x})=>{const o="#ffffec",l=s/150*(Math.PI*2),p=l%(Math.PI*2),v=Math.abs(p-3*Math.PI/4),w=Math.abs(p-7*Math.PI/4),h=Math.max(0,1-Math.min(v,w)/.15);if(h<=0)return null;const g=.5*h*(.5+c/100*.5),b=v<w,y=i*.4,M=.5,N=b?-.081:.081,r=.8-N*Math.sin(l),d=N*Math.cos(l);return e.jsxs("group",{position:[0,0,O],children:[e.jsxs("mesh",{position:[0,.8,2.5+d/2],rotation:[Math.PI/2,0,0],children:[e.jsx("cylinderGeometry",{args:[.06,.06,5-d,16,1,!0]}),e.jsx("meshStandardMaterial",{color:o,transparent:!0,opacity:g*.4,emissive:o,emissiveIntensity:2,side:2})]}),e.jsx("group",{position:[0,r,d],children:b?e.jsxs("mesh",{position:[0,(t-r)/2,0],children:[e.jsx("cylinderGeometry",{args:[y,M,t-r,16,1,!0]}),e.jsx("meshStandardMaterial",{color:o,transparent:!0,opacity:g,emissive:o,emissiveIntensity:2,side:2})]}):e.jsxs("mesh",{position:[0,(t-r)/2,0],children:[e.jsx("cylinderGeometry",{args:[M*.8,M*.8,t-r,16,1,!0]}),e.jsx("meshStandardMaterial",{color:o,transparent:!0,opacity:g,emissive:o,emissiveIntensity:2,side:2})]})}),e.jsxs("mesh",{position:[0,t+(2.8-t)/2,0],children:[e.jsx("cylinderGeometry",{args:[y*.3,y,2.8-t,16,1,!0]}),e.jsx("meshStandardMaterial",{color:"#ffffcc",transparent:!0,opacity:g*1.5,emissive:"#ffffcc",emissiveIntensity:3,side:2})]})]})},V=({coarsePos:c,finePos:s,onHover:t})=>{const i=c*.1,x=s*.5;return e.jsxs("group",{position:[0,1.2,-1],children:[e.jsxs("group",{onPointerOver:o=>{o.stopPropagation(),t("Limb / Curved Arm")},onPointerOut:()=>t(null),children:[e.jsx(u,{args:[.8,2,.8],position:[0,.5,0],children:e.jsx("meshStandardMaterial",{color:"#111"})}),e.jsx(u,{args:[.8,3,.8],position:[0,2.5,-.2],rotation:[-.2,0,0],children:e.jsx("meshStandardMaterial",{color:"#111"})}),e.jsx(u,{args:[.8,2,.8],position:[0,4.2,.5],rotation:[-Math.PI/3,0,0],children:e.jsx("meshStandardMaterial",{color:"#111"})})]}),e.jsxs("group",{position:[.4,2,-.1],children:[e.jsx(u,{args:[.6,.2,.2],position:[.2,0,0],children:e.jsx("meshStandardMaterial",{color:"#333"})}),e.jsx("group",{onPointerOver:o=>{o.stopPropagation(),t("Coarse Adjustment Knob")},onPointerOut:()=>t(null),children:e.jsx(I,{radius:.6,height:.3,rotation:i,position:[.4,0,0]})}),e.jsx("group",{onPointerOver:o=>{o.stopPropagation(),t("Fine Adjustment Knob")},onPointerOut:()=>t(null),children:e.jsx(I,{radius:.35,height:.25,rotation:x,position:[.7,0,0]})})]}),e.jsxs("group",{position:[-.4,2,-.1],children:[e.jsx(u,{args:[.6,.2,.2],position:[-.2,0,0],children:e.jsx("meshStandardMaterial",{color:"#333"})}),e.jsx("group",{onPointerOver:o=>{o.stopPropagation(),t("Coarse Adjustment Knob")},onPointerOut:()=>t(null),children:e.jsx(I,{radius:.6,height:.3,rotation:i,position:[-.4,0,0]})}),e.jsx("group",{onPointerOver:o=>{o.stopPropagation(),t("Fine Adjustment Knob")},onPointerOut:()=>t(null),children:e.jsx(I,{radius:.35,height:.25,rotation:x,position:[-.7,0,0]})})]})]})},W=({height:c,x:s,y:t,onHover:i})=>e.jsxs("group",{position:[0,c,O],children:[e.jsx(u,{args:[3,.15,3],onPointerOver:x=>{x.stopPropagation(),i("Mechanical Stage")},onPointerOut:()=>i(null),children:e.jsx("meshStandardMaterial",{color:"#111"})}),e.jsx(u,{args:[.1,.05,1.2],position:[.8,.1,.3],rotation:[0,.3,0],children:e.jsx("meshStandardMaterial",{color:"#ccc",metalness:.8})}),e.jsx(u,{args:[.1,.05,1.2],position:[-.8,.1,.3],rotation:[0,-.3,0],children:e.jsx("meshStandardMaterial",{color:"#ccc",metalness:.8})}),e.jsxs("group",{position:[s*.015,.1,t*.015],onPointerOver:x=>{x.stopPropagation(),i("Specimen Slide")},onPointerOut:()=>i(null),children:[e.jsx(u,{args:[2.5,.02,.8],children:e.jsx("meshPhysicalMaterial",{color:"white",transmission:.9,opacity:.5,transparent:!0})}),e.jsx(u,{args:[.8,.03,.5],position:[0,.01,0],children:e.jsx("meshBasicMaterial",{color:"#db2777",opacity:.6,transparent:!0})})]})]}),J=({objective:c,focus:s,onHover:t})=>{const i=P.useMemo(()=>{switch(c){case 4:return 0;case 10:return Math.PI/2;case 40:return Math.PI;case 100:return-Math.PI/2;default:return 0}},[c]),x=P.useRef(null);$(()=>{x.current&&(x.current.rotation.y=Y.lerp(x.current.rotation.y,i,.1))});const o=120,l=.45,p=.7,w=5.8-s/100*1.5;return e.jsxs("group",{position:[0,w,O],children:[e.jsxs("mesh",{position:[0,1.2,0],onPointerOver:h=>{h.stopPropagation(),t("Body Tube")},onPointerOut:()=>t(null),children:[e.jsx("cylinderGeometry",{args:[.45,.45,3.8]}),e.jsx("meshStandardMaterial",{color:"#0b1222",roughness:.3,metalness:.2})]}),e.jsxs("mesh",{position:[0,3,0],onPointerOver:h=>{h.stopPropagation(),t("Eyepiece Tube")},onPointerOut:()=>t(null),children:[e.jsx("cylinderGeometry",{args:[.25,.3,.8]}),e.jsx("meshStandardMaterial",{color:"#94a3b8",metalness:.9,roughness:.1})]}),e.jsxs("mesh",{position:[0,3.45,0],children:[e.jsx("cylinderGeometry",{args:[.32,.32,.15]}),e.jsx("meshStandardMaterial",{color:"#000"})]}),e.jsxs("group",{position:[0,-.65,-.7],rotation:[l,0,0],children:[e.jsxs("mesh",{position:[0,.22,0],children:[e.jsx("cylinderGeometry",{args:[1,1.3,.45,64]}),e.jsx("meshStandardMaterial",{color:"#1e293b",metalness:.5,roughness:.3})]}),e.jsxs("group",{ref:x,onPointerOver:h=>{h.stopPropagation(),t("Revolving Nosepiece / Turret")},onPointerOut:()=>t(null),children:[e.jsxs("mesh",{children:[e.jsx("cylinderGeometry",{args:[1.1,1.12,.2,64]}),e.jsx("meshStandardMaterial",{color:"#111",metalness:.8,roughness:.2})]}),Array.from({length:o}).map((h,g)=>e.jsxs("mesh",{position:[Math.cos(g/o*Math.PI*2)*1.12,0,Math.sin(g/o*Math.PI*2)*1.12],children:[e.jsx("boxGeometry",{args:[.02,.21,.02]}),e.jsx("meshStandardMaterial",{color:"#333",metalness:.5})]},g)),e.jsxs("group",{position:[0,-.3,p],rotation:[-l,0,0,"YXZ"],onPointerOver:h=>{h.stopPropagation(),t("4x Scanning Objective")},onPointerOut:()=>t(null),children:[e.jsxs("mesh",{position:[0,.25,0],children:[e.jsx("cylinderGeometry",{args:[.22,.22,.1]}),e.jsx("meshStandardMaterial",{color:"#94a3b8",metalness:.9})]}),e.jsxs("mesh",{children:[e.jsx("cylinderGeometry",{args:[.18,.22,.5]}),e.jsx("meshStandardMaterial",{color:"#ddd",metalness:.9})]}),e.jsxs("mesh",{position:[0,-.15,0],rotation:[Math.PI/2,0,0],children:[e.jsx("torusGeometry",{args:[.18,.03,16,32]}),e.jsx("meshBasicMaterial",{color:"red"})]}),e.jsx(C,{position:[.22,0,0],rotation:[0,Math.PI/2,0],fontSize:.14,color:"red",anchorX:"center",anchorY:"middle",children:"4x"})]}),e.jsxs("group",{position:[-p,-.3,0],rotation:[-l,-Math.PI/2,0,"YXZ"],onPointerOver:h=>{h.stopPropagation(),t("10x Low Power Objective")},onPointerOut:()=>t(null),children:[e.jsxs("mesh",{position:[0,.25,0],children:[e.jsx("cylinderGeometry",{args:[.22,.22,.1]}),e.jsx("meshStandardMaterial",{color:"#94a3b8",metalness:.9})]}),e.jsxs("mesh",{children:[e.jsx("cylinderGeometry",{args:[.18,.25,.7]}),e.jsx("meshStandardMaterial",{color:"#ddd",metalness:.9})]}),e.jsxs("mesh",{position:[0,-.2,0],rotation:[Math.PI/2,0,0],children:[e.jsx("torusGeometry",{args:[.18,.03,16,32]}),e.jsx("meshBasicMaterial",{color:"#fbbf24"})]}),e.jsx(C,{position:[.25,0,0],rotation:[0,Math.PI/2,0],fontSize:.14,color:"#fbbf24",anchorX:"center",anchorY:"middle",children:"10x"})]}),e.jsxs("group",{position:[0,-.3,-p],rotation:[-l,Math.PI,0,"YXZ"],onPointerOver:h=>{h.stopPropagation(),t("40x High Power Objective")},onPointerOut:()=>t(null),children:[e.jsxs("mesh",{position:[0,.25,0],children:[e.jsx("cylinderGeometry",{args:[.22,.22,.1]}),e.jsx("meshStandardMaterial",{color:"#94a3b8",metalness:.9})]}),e.jsxs("mesh",{children:[e.jsx("cylinderGeometry",{args:[.18,.25,1]}),e.jsx("meshStandardMaterial",{color:"#ddd",metalness:.9})]}),e.jsxs("mesh",{position:[0,-.35,0],rotation:[Math.PI/2,0,0],children:[e.jsx("torusGeometry",{args:[.18,.03,16,32]}),e.jsx("meshBasicMaterial",{color:"#3b82f6"})]}),e.jsx(C,{position:[.25,0,0],rotation:[0,Math.PI/2,0],fontSize:.14,color:"#3b82f6",anchorX:"center",anchorY:"middle",children:"40x"})]}),e.jsxs("group",{position:[p,-.3,0],rotation:[-l,Math.PI/2,0,"YXZ"],onPointerOver:h=>{h.stopPropagation(),t("100x Oil Immersion Objective")},onPointerOut:()=>t(null),children:[e.jsxs("mesh",{position:[0,.25,0],children:[e.jsx("cylinderGeometry",{args:[.22,.22,.1]}),e.jsx("meshStandardMaterial",{color:"#94a3b8",metalness:.9})]}),e.jsxs("mesh",{children:[e.jsx("cylinderGeometry",{args:[.18,.25,1.2]}),e.jsx("meshStandardMaterial",{color:"#ddd",metalness:.9})]}),e.jsxs("mesh",{position:[0,-.45,0],rotation:[Math.PI/2,0,0],children:[e.jsx("torusGeometry",{args:[.18,.03,16,32]}),e.jsx("meshBasicMaterial",{color:"white"})]}),e.jsx(C,{position:[.25,0,0],rotation:[0,Math.PI/2,0],fontSize:.14,color:"white",anchorX:"center",anchorY:"middle",children:"100x"})]})]})]})]})},Q=({focus:c,x:s,y:t,zoom:i,light:x,iris:o})=>{const l=P.useMemo(()=>{const a=[];let j=12345;const m=()=>(j=j*1103515245+12345&2147483647,j/2147483647);for(let f=0;f<3e3;f++)a.push({id:f,x:m()*900+50,y:m()*900+50});return a},[]),p=P.useMemo(()=>{const a=[],j={Neutrophil:60,Lymphocyte:30,Monocyte:5,Eosinophil:4,Basophil:1},m=[];Object.keys(j).forEach(n=>{for(let S=0;S<j[n];S++)m.push(n)});let f=54321;const k=()=>(f=f*1103515245+12345&2147483647,f/2147483647);for(let n=m.length-1;n>0;n--){const S=Math.floor(k()*(n+1));[m[n],m[S]]=[m[S],m[n]]}for(let n=0;n<33;n++)a.push({id:n,x:k()*800+100,y:k()*800+100,type:m[n]});return a},[]),v=a=>{const f=24*(a==="Monocyte"?1.2:1),n={Neutrophil:{bg:"#fce7f3",nucleus:"#581c87"},Lymphocyte:{bg:"#fce7f3",nucleus:"#4c1d95"},Monocyte:{bg:"#fce7f3",nucleus:"#6b21a8"},Eosinophil:{bg:"#fdf2f8",nucleus:"#7c3aed",accent:"#ef4444"},Basophil:{bg:"#eff6ff",nucleus:"#1e3a8a",accent:"#1e40af"}}[a];return e.jsxs("svg",{width:f,height:f,viewBox:"0 0 40 40",style:{display:"block"},children:[e.jsx("circle",{cx:"20",cy:"20",r:"18",fill:n.bg,stroke:"#f9a8d4",strokeWidth:"1"}),a==="Neutrophil"&&e.jsxs(e.Fragment,{children:[e.jsx("circle",{cx:"12",cy:"14",r:"6",fill:n.nucleus}),e.jsx("circle",{cx:"24",cy:"16",r:"5",fill:n.nucleus}),e.jsx("circle",{cx:"16",cy:"26",r:"6",fill:n.nucleus}),e.jsx("rect",{x:"12",y:"16",width:"10",height:"3",fill:n.nucleus,transform:"rotate(30 16 18)"})]}),a==="Lymphocyte"&&e.jsx("circle",{cx:"20",cy:"20",r:"15",fill:n.nucleus}),a==="Monocyte"&&e.jsx("ellipse",{cx:"20",cy:"20",rx:"12",ry:"10",fill:n.nucleus,transform:"rotate(-20 20 20)"}),a==="Eosinophil"&&e.jsxs(e.Fragment,{children:[e.jsx("circle",{cx:"12",cy:"20",r:"6",fill:n.nucleus,opacity:"0.7"}),e.jsx("circle",{cx:"28",cy:"20",r:"6",fill:n.nucleus,opacity:"0.7"}),e.jsx("rect",{x:"14",y:"18",width:"12",height:"4",fill:n.nucleus,opacity:"0.7"}),e.jsx("circle",{cx:"10",cy:"10",r:"2",fill:n.accent}),e.jsx("circle",{cx:"30",cy:"10",r:"2",fill:n.accent}),e.jsx("circle",{cx:"10",cy:"30",r:"2",fill:n.accent}),e.jsx("circle",{cx:"30",cy:"30",r:"2",fill:n.accent}),e.jsx("circle",{cx:"20",cy:"8",r:"1.6",fill:n.accent}),e.jsx("circle",{cx:"20",cy:"32",r:"1.6",fill:n.accent})]}),a==="Basophil"&&e.jsxs(e.Fragment,{children:[e.jsx("circle",{cx:"20",cy:"20",r:"10",fill:n.nucleus,opacity:"0.4"}),e.jsx("circle",{cx:"8",cy:"12",r:"3",fill:n.accent}),e.jsx("circle",{cx:"16",cy:"8",r:"3",fill:n.accent}),e.jsx("circle",{cx:"26",cy:"10",r:"3",fill:n.accent}),e.jsx("circle",{cx:"32",cy:"18",r:"3",fill:n.accent}),e.jsx("circle",{cx:"30",cy:"28",r:"3",fill:n.accent}),e.jsx("circle",{cx:"20",cy:"32",r:"3",fill:n.accent}),e.jsx("circle",{cx:"10",cy:"28",r:"3",fill:n.accent}),e.jsx("circle",{cx:"8",cy:"20",r:"3",fill:n.accent}),e.jsx("circle",{cx:"20",cy:"20",r:"2.4",fill:n.accent})]})]})},h=(a=>{switch(a){case 4:return .13;case 10:return .27;case 40:return .67;case 100:return 1.67;default:return 1}})(i),b={4:55,10:48,40:38,100:32}[i]||50,y=Math.abs(c-b),M=Math.max(0,y*.15*(i/10)),N=o||.8,r=Math.min(2,x/100*(1.2+N*.5)),d=1+(1-N)*.3;return e.jsxs("div",{className:"w-full h-full relative bg-[#ffeef2] overflow-hidden rounded-full shadow-2xl border-4 border-slate-900 flex items-center justify-center",children:[e.jsxs("div",{className:"absolute w-[1000px] h-[1000px] flex-none pointer-events-none",style:{transform:`scale(${h}) translate(${-s*10}px, ${-t*10}px)`,filter:`blur(${M}px) brightness(${r}) contrast(${d})`,transition:"transform 0.1s ease-out"},children:[l.map(a=>e.jsx("div",{className:"absolute rounded-full bg-red-500/20",style:{left:a.x,top:a.y,width:12,height:12}},`rbc-${a.id}`)),p.map(a=>e.jsx("div",{className:"absolute",style:{left:a.x,top:a.y,transform:"translate(-50%, -50%)"},children:v(a.type)},`wbc-${a.id}`))]}),e.jsx("div",{className:"absolute inset-0 pointer-events-none shadow-[inset_0_0_100px_rgba(0,0,0,0.7)]"}),e.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 text-[10px] font-bold text-white/50 bg-black/40 px-4 py-1.5 rounded-full whitespace-nowrap backdrop-blur-sm border border-white/10",children:M<.5?"âœ“ IN FOCUS":M<2?"FOCUSING...":"OUT OF FOCUS"})]})},se=({onBack:c})=>{const[s,t]=P.useState({coarseFocus:50,fineFocus:50,stageX:0,stageY:0,objective:4,lightIntensity:70,condenserHeight:50,irisOpening:.8,mirrorSide:"plane"}),[i,x]=P.useState("3d"),[o,l]=P.useState(null),p=s.coarseFocus+(s.fineFocus-50)*.1,v=F[s.objective],w=Math.min(p,v),h=(r,d)=>{const a=r+(d-50)*.1,j=F[s.objective];a>j?t(m=>({...m,coarseFocus:j-(m.fineFocus-50)*.1})):t(m=>({...m,coarseFocus:r,fineFocus:d}))},g=r=>{const d=F[r];p>d?t(a=>({...a,objective:r,coarseFocus:d-(a.fineFocus-50)*.1})):t(a=>({...a,objective:r}))},[b,y]=P.useState(null);L.useEffect(()=>{if(b===null)return;let r;const d=()=>{t(a=>{const j=b-a.lightIntensity;return Math.abs(j)<1?(y(null),{...a,lightIntensity:b}):{...a,lightIntensity:a.lightIntensity+j*.1}}),r=requestAnimationFrame(d)};return r=requestAnimationFrame(d),()=>cancelAnimationFrame(r)},[b]);const M=2.8,N=1.5+s.condenserHeight/100*.8;return e.jsxs("div",{className:"w-full h-screen bg-slate-950 flex flex-col overflow-hidden text-slate-200 font-sans",children:[e.jsxs("header",{className:"z-30 flex flex-col sm:flex-row items-start sm:items-center justify-between p-4 bg-slate-900 border-b border-slate-800 gap-4 flex-none shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:c,className:"p-2 bg-slate-800 rounded-full shadow-md hover:bg-slate-700 transition-colors border border-slate-700",children:e.jsx(E,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-base sm:text-xl font-bold tracking-tight leading-tight",children:"Classic Student Microscope"}),e.jsx("p",{className:"text-[10px] sm:text-xs text-slate-400 font-medium",children:"Mechanical Precision Simulation"})]})]}),e.jsxs("div",{className:"flex bg-slate-950 rounded-full shadow-inner p-1 border border-slate-800 w-full sm:w-auto",children:[e.jsx("button",{onClick:()=>x("3d"),className:`flex-1 sm:flex-none px-4 sm:px-6 py-2 rounded-full text-[10px] sm:text-xs font-bold transition-all ${i==="3d"?"bg-blue-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"3D VIEW"}),e.jsx("button",{onClick:()=>x("eyepiece"),className:`flex-1 sm:flex-none px-4 sm:px-6 py-2 rounded-full text-[10px] sm:text-xs font-bold transition-all ${i==="eyepiece"?"bg-blue-600 text-white shadow-lg":"text-slate-400 hover:text-slate-200"}`,children:"EYEPIECE"})]})]}),e.jsxs("main",{className:"flex-1 flex flex-col md:flex-row overflow-hidden relative",children:[e.jsxs("div",{className:"flex-1 relative bg-[#020617] order-1 min-h-[50vh]",children:[e.jsx("div",{className:`absolute inset-0 transition-opacity duration-500 ${i==="3d"?"opacity-100":"opacity-0 pointer-events-none"}`,children:e.jsxs(R,{shadows:!0,camera:{position:[7,5,7],fov:35},children:[e.jsx(z,{preset:"studio"}),e.jsx("ambientLight",{intensity:.5}),e.jsx("directionalLight",{position:[10,10,10],intensity:1,castShadow:!0}),e.jsxs("group",{position:[0,-3,0],children:[e.jsx(K,{onHover:l}),e.jsx(D,{intensity:s.lightIntensity,onHover:l}),e.jsx(V,{coarsePos:s.coarseFocus,finePos:s.fineFocus,onHover:l}),e.jsx(W,{height:M,x:s.stageX,y:s.stageY,onHover:l}),e.jsx(U,{height:s.condenserHeight,iris:s.irisOpening,intensity:s.lightIntensity,onHover:l}),e.jsx(q,{intensity:s.lightIntensity,mirrorTilt:s.lightIntensity,condenserY:N,iris:s.irisOpening,side:s.mirrorSide}),e.jsx(J,{objective:s.objective,focus:w,onHover:l})]}),e.jsx(B,{minPolarAngle:0,maxPolarAngle:Math.PI/2,target:[0,2,0]})]})}),e.jsx("div",{className:`absolute inset-0 bg-black flex items-center justify-center z-20 transition-opacity duration-500 ${i==="eyepiece"?"opacity-100":"opacity-0 pointer-events-none"}`,children:e.jsx("div",{className:"w-[85vw] h-[85vw] max-w-[500px] max-h-[500px]",children:e.jsx(Q,{focus:p,x:s.stageX,y:s.stageY,zoom:s.objective,light:s.lightIntensity,iris:s.irisOpening})})}),o&&e.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 z-40 animate-in fade-in zoom-in duration-200",children:e.jsxs("div",{className:"px-5 py-2.5 bg-slate-900/90 backdrop-blur-md border border-blue-500/30 rounded-full shadow-[0_0_30px_rgba(59,130,246,0.3)] flex items-center gap-3",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-blue-500 animate-pulse"}),e.jsx("span",{className:"text-blue-50 font-bold tracking-wider text-[11px] uppercase",children:o})]})})]}),e.jsxs("aside",{className:"w-full md:w-80 bg-slate-900 border-t md:border-t-0 md:border-l border-slate-800 flex flex-col z-10 shadow-2xl order-2 flex-1 md:flex-none overflow-hidden",children:[e.jsxs("div",{className:"p-4 border-b border-slate-800 flex items-center gap-2 bg-slate-900/50",children:[e.jsx(A,{className:"w-4 h-4 text-blue-500"}),e.jsx("h2",{className:"font-bold text-sm tracking-wide uppercase text-slate-100",children:"Lab Controls"})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-10 custom-scrollbar",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"text-[10px] font-bold uppercase text-slate-500 mb-4 block flex items-center gap-1 tracking-widest",children:[e.jsx(T,{className:"w-3 h-3"})," Objective Lens"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:[4,10,40,100].map(r=>e.jsxs("button",{onClick:()=>g(r),className:`py-3 rounded-lg border font-bold text-sm transition-all ${s.objective===r?"bg-blue-600 border-blue-400 text-white shadow-lg":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-700 font-normal"}`,children:[r,"x"]},r))})]}),e.jsxs("div",{className:"bg-slate-800/40 p-5 rounded-xl border border-slate-700/50",children:[e.jsxs("label",{className:"text-[10px] font-bold uppercase text-slate-500 mb-5 block flex items-center gap-1 tracking-widest",children:[e.jsx(_,{className:"w-3 h-3"})," Focus Mechanics"]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between text-[10px] text-slate-400 mb-3 font-semibold uppercase tracking-tighter",children:"Coarse Adjustment"}),e.jsx("input",{type:"range",min:"0",max:"100",value:s.coarseFocus,onChange:r=>h(+r.target.value,s.fineFocus),className:"w-full h-1.5 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-blue-600"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between text-[10px] text-slate-400 mb-3 font-semibold uppercase tracking-tighter",children:"Fine Adjustment"}),e.jsx("input",{type:"range",min:"0",max:"100",value:s.fineFocus,onChange:r=>h(s.coarseFocus,+r.target.value),className:"w-full h-1 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-blue-400"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/40 p-5 rounded-xl border border-slate-700/50",children:[e.jsxs("label",{className:"text-[10px] font-bold uppercase text-slate-500 mb-5 block flex items-center gap-1 tracking-widest",children:[e.jsx(A,{className:"w-3 h-3"})," Specimen Position"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-[10px] text-slate-500 block mb-2 font-bold opacity-80",children:"LATERAL (X)"}),e.jsx("input",{type:"range",min:"-50",max:"50",value:s.stageX,onChange:r=>t(d=>({...d,stageX:+r.target.value})),className:"w-full accent-green-600"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"text-[10px] text-slate-500 block mb-2 font-bold opacity-80",children:"LONGITUDINAL (Y)"}),e.jsx("input",{type:"range",min:"-50",max:"50",value:s.stageY,onChange:r=>t(d=>({...d,stageY:+r.target.value})),className:"w-full accent-green-600"})]})]})]}),e.jsxs("div",{className:"bg-slate-800/40 p-5 rounded-xl border border-slate-700/50",children:[e.jsxs("label",{className:"text-[10px] font-bold uppercase text-slate-500 mb-4 block flex items-center gap-1 tracking-widest",children:[e.jsx(Z,{className:"w-3 h-3"})," Illumination Mirror"]}),e.jsxs("div",{className:"flex bg-slate-900 rounded-lg p-1 mb-4 border border-slate-700",children:[e.jsx("button",{onClick:()=>{t(r=>({...r,mirrorSide:"plane"})),y(131)},className:`flex-1 py-3 rounded-md text-[10px] font-bold transition-all ${s.mirrorSide==="plane"?"bg-slate-700 text-white shadow-md":"text-slate-500 hover:text-slate-300"}`,children:"PLANE"}),e.jsx("button",{onClick:()=>{t(r=>({...r,mirrorSide:"concave"})),y(56)},className:`flex-1 py-3 rounded-md text-[10px] font-bold transition-all ${s.mirrorSide==="concave"?"bg-slate-700 text-white shadow-md":"text-slate-500 hover:text-slate-300"}`,children:"CONCAVE"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex justify-between text-[10px] text-slate-400 font-semibold uppercase tracking-widest",children:"Mirror Tilt"}),e.jsx("input",{type:"range",min:"0",max:"150",value:s.lightIntensity,onChange:r=>t(d=>({...d,lightIntensity:+r.target.value})),className:"w-full h-1.5 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-yellow-400"})]})]}),e.jsxs("div",{className:"bg-slate-800/40 p-5 rounded-xl border border-slate-700/50",children:[e.jsxs("label",{className:"text-[10px] font-bold uppercase text-slate-500 mb-5 block flex items-center gap-1 tracking-widest",children:[e.jsx(T,{className:"w-3 h-3"})," Condenser & Iris"]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between text-[10px] text-slate-400 mb-2 font-semibold",children:"Condenser Height"}),e.jsx("input",{type:"range",min:"0",max:"100",value:s.condenserHeight,onChange:r=>t(d=>({...d,condenserHeight:+r.target.value})),className:"w-full h-1.5 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-cyan-500"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between text-[10px] text-slate-400 mb-2 font-semibold",children:"Iris Diaphragm Opening"}),e.jsx("input",{type:"range",min:"0.1",max:"1.0",step:"0.05",value:s.irisOpening,onChange:r=>t(d=>({...d,irisOpening:+r.target.value})),className:"w-full h-1.5 bg-slate-800 rounded-lg appearance-none cursor-pointer accent-purple-500"})]})]})]})]})]})]})]})};export{se as Microscope3D};
